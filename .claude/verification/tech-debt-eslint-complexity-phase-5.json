[{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/(auth)/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/(auth)/login/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/(auth)/signup/page.tsx","messages":[{"ruleId":"complexity","severity":2,"message":"Function 'SignupForm' has a complexity of 12. Maximum allowed is 10.","line":10,"column":1,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":10,"endColumn":20}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { Suspense, useState } from \"react\";\nimport { signIn } from \"next-auth/react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport Link from \"next/link\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\n\nfunction SignupForm() {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const plan = searchParams.get(\"plan\");\n  const callbackUrl = searchParams.get(\"callbackUrl\") || \"/dashboard\";\n\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n  const [name, setName] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [validationErrors, setValidationErrors] = useState<{\n    email?: string;\n    password?: string;\n    confirmPassword?: string;\n  }>({});\n\n  const validateForm = (): boolean => {\n    const errors: typeof validationErrors = {};\n\n    // Email validation\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!emailRegex.test(email)) {\n      errors.email = \"Please enter a valid email address\";\n    }\n\n    // Password strength validation\n    if (password.length < 8) {\n      errors.password = \"Password must be at least 8 characters\";\n    } else if (!/[A-Z]/.test(password)) {\n      errors.password = \"Password must contain at least one uppercase letter\";\n    } else if (!/[a-z]/.test(password)) {\n      errors.password = \"Password must contain at least one lowercase letter\";\n    } else if (!/[0-9]/.test(password)) {\n      errors.password = \"Password must contain at least one number\";\n    }\n\n    // Confirm password\n    if (password !== confirmPassword) {\n      errors.confirmPassword = \"Passwords do not match\";\n    }\n\n    setValidationErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n\n    if (!validateForm()) {\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      const response = await fetch(\"/api/auth/signup\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          email,\n          password,\n          confirmPassword,\n          name: name || undefined,\n        }),\n      });\n\n      const data = await response.json();\n\n      if (!response.ok) {\n        setError(data.error || \"An error occurred during signup\");\n        return;\n      }\n\n      // Auto sign in after successful signup\n      const signInResult = await signIn(\"credentials\", {\n        email,\n        password,\n        redirect: false,\n      });\n\n      if (signInResult?.error) {\n        // Account created but sign in failed - redirect to login\n        router.push(\"/login?message=Account created. Please sign in.\");\n      } else {\n        router.push(callbackUrl);\n        router.refresh();\n      }\n    } catch {\n      setError(\"An unexpected error occurred\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleGoogleSignIn = () => {\n    signIn(\"google\", { callbackUrl });\n  };\n\n  return (\n    <div className=\"w-full max-w-md\">\n      <div className=\"bg-white rounded-lg shadow-md p-8\">\n        <h1 className=\"text-2xl font-bold text-center text-gray-900 mb-2\">\n          Create your account\n        </h1>\n        {plan && (\n          <p className=\"text-center text-gray-600 mb-6\">\n            Sign up to get started with the{\" \"}\n            <span className=\"font-medium capitalize\">{plan}</span> plan\n          </p>\n        )}\n        {!plan && (\n          <p className=\"text-center text-gray-600 mb-6\">\n            Sign up to create dynamic QR codes\n          </p>\n        )}\n\n        {error && (\n          <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm\">\n            {error}\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div>\n            <label\n              htmlFor=\"name\"\n              className=\"block text-sm font-medium text-gray-700 mb-1\"\n            >\n              Name <span className=\"text-gray-400\">(optional)</span>\n            </label>\n            <Input\n              id=\"name\"\n              type=\"text\"\n              value={name}\n              onChange={(e) => setName(e.target.value)}\n              placeholder=\"Your name\"\n              disabled={isLoading}\n            />\n          </div>\n\n          <div>\n            <label\n              htmlFor=\"email\"\n              className=\"block text-sm font-medium text-gray-700 mb-1\"\n            >\n              Email\n            </label>\n            <Input\n              id=\"email\"\n              type=\"email\"\n              value={email}\n              onChange={(e) => {\n                setEmail(e.target.value);\n                setValidationErrors((prev) => ({ ...prev, email: undefined }));\n              }}\n              placeholder=\"you@example.com\"\n              required\n              disabled={isLoading}\n              className={validationErrors.email ? \"border-red-500\" : \"\"}\n            />\n            {validationErrors.email && (\n              <p className=\"mt-1 text-sm text-red-600\">\n                {validationErrors.email}\n              </p>\n            )}\n          </div>\n\n          <div>\n            <label\n              htmlFor=\"password\"\n              className=\"block text-sm font-medium text-gray-700 mb-1\"\n            >\n              Password\n            </label>\n            <Input\n              id=\"password\"\n              type=\"password\"\n              value={password}\n              onChange={(e) => {\n                setPassword(e.target.value);\n                setValidationErrors((prev) => ({\n                  ...prev,\n                  password: undefined,\n                }));\n              }}\n              placeholder=\"Create a password\"\n              required\n              disabled={isLoading}\n              className={validationErrors.password ? \"border-red-500\" : \"\"}\n            />\n            {validationErrors.password && (\n              <p className=\"mt-1 text-sm text-red-600\">\n                {validationErrors.password}\n              </p>\n            )}\n            <p className=\"mt-1 text-xs text-gray-500\">\n              8+ characters with uppercase, lowercase, and number\n            </p>\n          </div>\n\n          <div>\n            <label\n              htmlFor=\"confirmPassword\"\n              className=\"block text-sm font-medium text-gray-700 mb-1\"\n            >\n              Confirm Password\n            </label>\n            <Input\n              id=\"confirmPassword\"\n              type=\"password\"\n              value={confirmPassword}\n              onChange={(e) => {\n                setConfirmPassword(e.target.value);\n                setValidationErrors((prev) => ({\n                  ...prev,\n                  confirmPassword: undefined,\n                }));\n              }}\n              placeholder=\"Confirm your password\"\n              required\n              disabled={isLoading}\n              className={\n                validationErrors.confirmPassword ? \"border-red-500\" : \"\"\n              }\n            />\n            {validationErrors.confirmPassword && (\n              <p className=\"mt-1 text-sm text-red-600\">\n                {validationErrors.confirmPassword}\n              </p>\n            )}\n          </div>\n\n          <Button\n            type=\"submit\"\n            variant=\"primary\"\n            className=\"w-full\"\n            disabled={isLoading}\n          >\n            {isLoading ? \"Creating account...\" : \"Sign up\"}\n          </Button>\n        </form>\n\n        <div className=\"mt-6\">\n          <div className=\"relative\">\n            <div className=\"absolute inset-0 flex items-center\">\n              <div className=\"w-full border-t border-gray-300\" />\n            </div>\n            <div className=\"relative flex justify-center text-sm\">\n              <span className=\"px-2 bg-white text-gray-500\">\n                Or continue with\n              </span>\n            </div>\n          </div>\n\n          <button\n            onClick={handleGoogleSignIn}\n            disabled={isLoading}\n            className=\"mt-4 w-full flex items-center justify-center gap-3 px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\">\n              <path\n                fill=\"currentColor\"\n                d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"\n              />\n              <path\n                fill=\"currentColor\"\n                d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"\n              />\n              <path\n                fill=\"currentColor\"\n                d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"\n              />\n              <path\n                fill=\"currentColor\"\n                d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"\n              />\n            </svg>\n            Sign up with Google\n          </button>\n        </div>\n\n        <p className=\"mt-6 text-center text-sm text-gray-600\">\n          Already have an account?{\" \"}\n          <Link\n            href=\"/login\"\n            className=\"font-medium text-blue-600 hover:text-blue-500\"\n          >\n            Log in\n          </Link>\n        </p>\n      </div>\n    </div>\n  );\n}\n\nexport default function SignupPage() {\n  return (\n    <Suspense\n      fallback={\n        <div className=\"w-full max-w-md\">\n          <div className=\"bg-white rounded-lg shadow-md p-8 animate-pulse\">\n            <div className=\"h-8 bg-gray-200 rounded w-3/4 mx-auto mb-6\" />\n            <div className=\"space-y-4\">\n              <div className=\"h-10 bg-gray-200 rounded\" />\n              <div className=\"h-10 bg-gray-200 rounded\" />\n              <div className=\"h-10 bg-gray-200 rounded\" />\n              <div className=\"h-10 bg-gray-200 rounded\" />\n            </div>\n          </div>\n        </div>\n      }\n    >\n      <SignupForm />\n    </Suspense>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/(dashboard)/billing/billing-client.tsx","messages":[{"ruleId":"complexity","severity":2,"message":"Function 'BillingClient' has a complexity of 14. Maximum allowed is 10.","line":48,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":48,"endColumn":30}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState } from \"react\";\nimport { useSearchParams } from \"next/navigation\";\n\ninterface BillingClientProps {\n  subscription: {\n    id: string;\n    plan: \"pro\" | \"business\";\n    status: string;\n    currentPeriodEnd: string;\n  } | null;\n  usage: {\n    count: number;\n    limit: number | null;\n    plan: \"pro\" | \"business\" | null;\n  };\n}\n\nconst PLANS = [\n  {\n    id: \"pro\",\n    name: \"Pro\",\n    monthlyPrice: 5,\n    annualPrice: 36,\n    features: [\n      \"Up to 10 dynamic QR codes\",\n      \"Scan analytics\",\n      \"Edit destination URLs anytime\",\n      \"Folders for organization\",\n    ],\n  },\n  {\n    id: \"business\",\n    name: \"Business\",\n    monthlyPrice: 15,\n    annualPrice: 120,\n    features: [\n      \"Unlimited dynamic QR codes\",\n      \"Advanced analytics\",\n      \"CSV export\",\n      \"Priority support\",\n      \"Custom branding (coming soon)\",\n    ],\n  },\n] as const;\n\nexport function BillingClient({ subscription, usage }: BillingClientProps) {\n  const searchParams = useSearchParams();\n  const [loading, setLoading] = useState<string | null>(null);\n  const [billingPeriod, setBillingPeriod] = useState<\"monthly\" | \"annual\">(\n    \"monthly\"\n  );\n\n  const success = searchParams.get(\"success\") === \"true\";\n  const canceled = searchParams.get(\"canceled\") === \"true\";\n\n  const handleSubscribe = async (plan: \"pro\" | \"business\") => {\n    setLoading(plan);\n    try {\n      const response = await fetch(\"/api/stripe/checkout\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ plan, period: billingPeriod }),\n      });\n\n      const data = await response.json();\n\n      if (data.url) {\n        window.location.href = data.url;\n      } else {\n        alert(data.error || \"Failed to create checkout session\");\n      }\n    } catch (error) {\n      console.error(\"Checkout error:\", error);\n      alert(\"Something went wrong. Please try again.\");\n    } finally {\n      setLoading(null);\n    }\n  };\n\n  const handleManageSubscription = async () => {\n    setLoading(\"portal\");\n    try {\n      const response = await fetch(\"/api/stripe/portal\", {\n        method: \"POST\",\n      });\n\n      const data = await response.json();\n\n      if (data.url) {\n        window.location.href = data.url;\n      } else {\n        alert(data.error || \"Failed to open customer portal\");\n      }\n    } catch (error) {\n      console.error(\"Portal error:\", error);\n      alert(\"Something went wrong. Please try again.\");\n    } finally {\n      setLoading(null);\n    }\n  };\n\n  return (\n    <div className=\"space-y-8\">\n      {/* Success/Cancel Messages */}\n      {success && (\n        <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\n          <p className=\"text-green-800\">\n            Thank you for subscribing! Your subscription is now active.\n          </p>\n        </div>\n      )}\n      {canceled && (\n        <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\n          <p className=\"text-yellow-800\">\n            Checkout was canceled. You can try again when you&apos;re ready.\n          </p>\n        </div>\n      )}\n\n      {/* Current Plan */}\n      {subscription ? (\n        <div className=\"bg-white border border-gray-200 rounded-lg p-6\">\n          <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">\n            Current Plan\n          </h2>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-2xl font-bold text-gray-900 capitalize\">\n                {subscription.plan}\n              </p>\n              <p className=\"text-sm text-gray-500\">\n                Status:{\" \"}\n                <span\n                  className={\n                    subscription.status === \"active\"\n                      ? \"text-green-600\"\n                      : \"text-yellow-600\"\n                  }\n                >\n                  {subscription.status}\n                </span>\n              </p>\n              <p className=\"text-sm text-gray-500\">\n                Renews:{\" \"}\n                {new Date(subscription.currentPeriodEnd).toLocaleDateString()}\n              </p>\n            </div>\n            <button\n              onClick={handleManageSubscription}\n              disabled={loading === \"portal\"}\n              className=\"px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50\"\n            >\n              {loading === \"portal\" ? \"Loading...\" : \"Manage Subscription\"}\n            </button>\n          </div>\n\n          {/* Usage */}\n          {usage.limit && (\n            <div className=\"mt-6 pt-6 border-t border-gray-200\">\n              <h3 className=\"text-sm font-medium text-gray-700 mb-2\">Usage</h3>\n              <div className=\"flex items-center gap-4\">\n                <div className=\"flex-1 bg-gray-200 rounded-full h-2\">\n                  <div\n                    className=\"bg-blue-600 h-2 rounded-full transition-all\"\n                    style={{\n                      width: `${Math.min((usage.count / usage.limit) * 100, 100)}%`,\n                    }}\n                  />\n                </div>\n                <span className=\"text-sm text-gray-600\">\n                  {usage.count} / {usage.limit} QR codes\n                </span>\n              </div>\n              {usage.count >= usage.limit && (\n                <p className=\"mt-2 text-sm text-orange-600\">\n                  You&apos;ve reached your limit. Upgrade to Business for unlimited\n                  codes.\n                </p>\n              )}\n            </div>\n          )}\n\n          {/* Upgrade prompt for Pro users */}\n          {subscription.plan === \"pro\" && (\n            <div className=\"mt-6 pt-6 border-t border-gray-200\">\n              <p className=\"text-sm text-gray-600 mb-3\">\n                Need more? Upgrade to Business for unlimited QR codes.\n              </p>\n              <button\n                onClick={() => handleSubscribe(\"business\")}\n                disabled={loading === \"business\"}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50\"\n              >\n                {loading === \"business\" ? \"Loading...\" : \"Upgrade to Business\"}\n              </button>\n            </div>\n          )}\n        </div>\n      ) : (\n        <>\n          {/* No subscription - show plans */}\n          <div className=\"bg-white border border-gray-200 rounded-lg p-6\">\n            <h2 className=\"text-lg font-semibold text-gray-900 mb-2\">\n              Choose a Plan\n            </h2>\n            <p className=\"text-gray-600 mb-6\">\n              Subscribe to create dynamic QR codes that you can edit anytime.\n            </p>\n\n            {/* Billing period toggle */}\n            <div className=\"flex items-center justify-center gap-4 mb-8\">\n              <button\n                onClick={() => setBillingPeriod(\"monthly\")}\n                className={`px-4 py-2 rounded-lg transition-colors ${\n                  billingPeriod === \"monthly\"\n                    ? \"bg-gray-900 text-white\"\n                    : \"bg-gray-100 text-gray-700 hover:bg-gray-200\"\n                }`}\n              >\n                Monthly\n              </button>\n              <button\n                onClick={() => setBillingPeriod(\"annual\")}\n                className={`px-4 py-2 rounded-lg transition-colors ${\n                  billingPeriod === \"annual\"\n                    ? \"bg-gray-900 text-white\"\n                    : \"bg-gray-100 text-gray-700 hover:bg-gray-200\"\n                }`}\n              >\n                Annual\n                <span className=\"ml-2 text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full\">\n                  Save up to 40%\n                </span>\n              </button>\n            </div>\n\n            {/* Plan cards */}\n            <div className=\"grid md:grid-cols-2 gap-6\">\n              {PLANS.map((plan) => (\n                <div\n                  key={plan.id}\n                  className=\"border border-gray-200 rounded-lg p-6 hover:border-gray-300 transition-colors\"\n                >\n                  <h3 className=\"text-xl font-bold text-gray-900\">\n                    {plan.name}\n                  </h3>\n                  <div className=\"mt-2\">\n                    <span className=\"text-3xl font-bold text-gray-900\">\n                      $\n                      {billingPeriod === \"monthly\"\n                        ? plan.monthlyPrice\n                        : plan.annualPrice}\n                    </span>\n                    <span className=\"text-gray-500\">\n                      /{billingPeriod === \"monthly\" ? \"mo\" : \"yr\"}\n                    </span>\n                    {billingPeriod === \"annual\" && (\n                      <p className=\"text-sm text-green-600 mt-1\">\n                        ${(plan.annualPrice / 12).toFixed(0)}/mo billed annually\n                      </p>\n                    )}\n                  </div>\n\n                  <ul className=\"mt-6 space-y-3\">\n                    {plan.features.map((feature) => (\n                      <li\n                        key={feature}\n                        className=\"flex items-start gap-2 text-sm text-gray-600\"\n                      >\n                        <svg\n                          className=\"w-5 h-5 text-green-500 shrink-0\"\n                          fill=\"none\"\n                          stroke=\"currentColor\"\n                          viewBox=\"0 0 24 24\"\n                        >\n                          <path\n                            strokeLinecap=\"round\"\n                            strokeLinejoin=\"round\"\n                            strokeWidth={2}\n                            d=\"M5 13l4 4L19 7\"\n                          />\n                        </svg>\n                        {feature}\n                      </li>\n                    ))}\n                  </ul>\n\n                  <button\n                    onClick={() => handleSubscribe(plan.id)}\n                    disabled={loading === plan.id}\n                    className=\"mt-6 w-full px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50\"\n                  >\n                    {loading === plan.id ? \"Loading...\" : `Subscribe to ${plan.name}`}\n                  </button>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          {/* Existing QR codes notice */}\n          {usage.count > 0 && (\n            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n              <p className=\"text-blue-800\">\n                You have {usage.count} QR code{usage.count !== 1 ? \"s\" : \"\"}{\" \"}\n                created. Subscribe to manage and track them.\n              </p>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/(dashboard)/billing/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/(dashboard)/dashboard/page.tsx","messages":[{"ruleId":"complexity","severity":2,"message":"Async function 'DashboardPage' has a complexity of 41. Maximum allowed is 10.","line":20,"column":16,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":20,"endColumn":44}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Suspense } from \"react\";\nimport { auth } from \"@/lib/auth\";\nimport { db } from \"@/lib/db\";\nimport { qrCodes, folders } from \"@/lib/db/schema\";\nimport { eq, desc, asc, sql, and, isNull } from \"drizzle-orm\";\nimport { QRCard } from \"@/components/qr-card\";\nimport { FolderSidebar } from \"@/components/folder-sidebar\";\nimport { buildShortUrl } from \"@/lib/qr\";\nimport Link from \"next/link\";\n\ninterface DashboardPageProps {\n  searchParams: Promise<{\n    page?: string;\n    sort?: string;\n    order?: string;\n    folderId?: string;\n  }>;\n}\n\nexport default async function DashboardPage({ searchParams }: DashboardPageProps) {\n  const session = await auth();\n  const params = await searchParams;\n\n  if (!session?.user?.id) {\n    return null; // Layout handles redirect\n  }\n\n  const page = Math.max(1, parseInt(params.page || \"1\", 10));\n  const sort = params.sort || \"createdAt\";\n  const order = params.order || \"desc\";\n  const folderId = params.folderId || null;\n  const limit = 12;\n  const offset = (page - 1) * limit;\n\n  // Build order clause\n  const orderColumn = sort === \"scanCount\" ? qrCodes.scanCount : qrCodes.createdAt;\n  const orderDirection = order === \"asc\" ? asc(orderColumn) : desc(orderColumn);\n\n  // Build where conditions\n  const whereConditions = [eq(qrCodes.userId, session.user.id)];\n  if (folderId) {\n    if (folderId === \"none\") {\n      whereConditions.push(isNull(qrCodes.folderId));\n    } else {\n      whereConditions.push(eq(qrCodes.folderId, folderId));\n    }\n  }\n\n  // Fetch QR codes\n  const codes = await db\n    .select()\n    .from(qrCodes)\n    .where(and(...whereConditions))\n    .orderBy(orderDirection)\n    .limit(limit)\n    .offset(offset);\n\n  // Get total count for current filter\n  const countResult = await db\n    .select({ count: sql<number>`count(*)` })\n    .from(qrCodes)\n    .where(and(...whereConditions));\n\n  const total = Number(countResult[0]?.count || 0);\n  const totalPages = Math.ceil(total / limit);\n\n  // Get all QR codes count (for total display)\n  const allCountResult = await db\n    .select({ count: sql<number>`count(*)` })\n    .from(qrCodes)\n    .where(eq(qrCodes.userId, session.user.id));\n  const allTotal = Number(allCountResult[0]?.count || 0);\n\n  // Fetch user's folders\n  const userFolders = await db\n    .select({\n      id: folders.id,\n      name: folders.name,\n      qrCount: sql<number>`(\n        SELECT COUNT(*)::int\n        FROM ${qrCodes}\n        WHERE ${qrCodes.folderId} = ${folders.id}\n      )`,\n    })\n    .from(folders)\n    .where(eq(folders.userId, session.user.id))\n    .orderBy(folders.name);\n\n  // Transform for display\n  const qrCodesData = codes.map((code) => ({\n    id: code.id,\n    shortCode: code.shortCode,\n    shortUrl: buildShortUrl(code.shortCode),\n    destinationUrl: code.destinationUrl,\n    name: code.name,\n    scanCount: code.scanCount,\n    isActive: code.isActive,\n    createdAt: code.createdAt.toISOString(),\n  }));\n\n  const foldersData = userFolders.map((f) => ({\n    id: f.id,\n    name: f.name,\n    qrCount: f.qrCount,\n  }));\n\n  const buildQueryString = (newParams: Record<string, string | undefined>) => {\n    const merged = { ...params, ...newParams };\n    const searchParams = new URLSearchParams();\n    Object.entries(merged).forEach(([key, value]) => {\n      if (value && key !== \"page\") {\n        searchParams.set(key, value);\n      }\n    });\n    if (newParams.page && newParams.page !== \"1\") {\n      searchParams.set(\"page\", newParams.page);\n    }\n    const qs = searchParams.toString();\n    return qs ? `?${qs}` : \"\";\n  };\n\n  return (\n    <div className=\"flex gap-6\">\n      {/* Folder sidebar */}\n      {(foldersData.length > 0 || allTotal > 0) && (\n        <aside className=\"w-64 flex-shrink-0 hidden lg:block\">\n          <Suspense fallback={<div className=\"h-40 bg-gray-100 rounded-lg animate-pulse\" />}>\n            <FolderSidebar folders={foldersData} currentFolderId={folderId} />\n          </Suspense>\n        </aside>\n      )}\n\n      {/* Main content */}\n      <div className=\"flex-1 min-w-0\">\n        <div className=\"flex items-center justify-between mb-8\">\n          <h1 className=\"text-2xl font-bold text-gray-900\">My QR Codes</h1>\n          <Link\n            href=\"/qr/new\"\n            className=\"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n          >\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\n            </svg>\n            Create New\n          </Link>\n        </div>\n\n        {allTotal === 0 ? (\n          // Empty state - no QR codes at all\n          <div className=\"bg-white rounded-lg border border-gray-200 p-12 text-center\">\n            <div className=\"mx-auto w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4\">\n              <svg\n                className=\"w-8 h-8 text-gray-400\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M12 4v16m8-8H4\"\n                />\n              </svg>\n            </div>\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No QR codes yet</h3>\n            <p className=\"text-gray-600 mb-6\">\n              {session.user.name ? `Welcome, ${session.user.name}! ` : \"Welcome! \"}\n              Create your first dynamic QR code to get started.\n            </p>\n            <Link\n              href=\"/qr/new\"\n              className=\"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n            >\n              <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\n              </svg>\n              Create Your First QR Code\n            </Link>\n          </div>\n        ) : total === 0 && folderId ? (\n          // Empty state for folder filter\n          <div className=\"bg-white rounded-lg border border-gray-200 p-12 text-center\">\n            <div className=\"mx-auto w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4\">\n              <svg\n                className=\"w-8 h-8 text-gray-400\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z\" />\n              </svg>\n            </div>\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">This folder is empty</h3>\n            <p className=\"text-gray-600 mb-6\">\n              Move QR codes to this folder or create a new one.\n            </p>\n            <Link\n              href=\"/dashboard\"\n              className=\"text-blue-600 hover:text-blue-700 font-medium\"\n            >\n              View all QR codes\n            </Link>\n          </div>\n        ) : (\n          <>\n            {/* Sort controls */}\n            <div className=\"flex items-center gap-4 mb-6 flex-wrap\">\n              <span className=\"text-sm text-gray-500\">Sort by:</span>\n              <div className=\"flex gap-2\">\n                <Link\n                  href={`/dashboard${buildQueryString({ sort: \"createdAt\", order: sort === \"createdAt\" && order === \"desc\" ? \"asc\" : \"desc\", folderId: folderId || undefined })}`}\n                  className={`px-3 py-1.5 text-sm rounded-lg transition-colors ${\n                    sort === \"createdAt\"\n                      ? \"bg-blue-100 text-blue-700\"\n                      : \"bg-gray-100 text-gray-600 hover:bg-gray-200\"\n                  }`}\n                >\n                  Date Created {sort === \"createdAt\" && (order === \"desc\" ? \"↓\" : \"↑\")}\n                </Link>\n                <Link\n                  href={`/dashboard${buildQueryString({ sort: \"scanCount\", order: sort === \"scanCount\" && order === \"desc\" ? \"asc\" : \"desc\", folderId: folderId || undefined })}`}\n                  className={`px-3 py-1.5 text-sm rounded-lg transition-colors ${\n                    sort === \"scanCount\"\n                      ? \"bg-blue-100 text-blue-700\"\n                      : \"bg-gray-100 text-gray-600 hover:bg-gray-200\"\n                  }`}\n                >\n                  Scan Count {sort === \"scanCount\" && (order === \"desc\" ? \"↓\" : \"↑\")}\n                </Link>\n              </div>\n              <span className=\"ml-auto text-sm text-gray-500\">\n                {total} QR code{total !== 1 ? \"s\" : \"\"}\n                {folderId && ` in folder`}\n              </span>\n            </div>\n\n            {/* QR code grid */}\n            <div className=\"grid gap-4 sm:grid-cols-2 xl:grid-cols-3\">\n              {qrCodesData.map((qr) => (\n                <QRCard\n                  key={qr.id}\n                  id={qr.id}\n                  shortCode={qr.shortCode}\n                  shortUrl={qr.shortUrl}\n                  destinationUrl={qr.destinationUrl}\n                  name={qr.name}\n                  scanCount={qr.scanCount}\n                  isActive={qr.isActive}\n                  createdAt={qr.createdAt}\n                />\n              ))}\n            </div>\n\n            {/* Pagination */}\n            {totalPages > 1 && (\n              <div className=\"mt-8 flex items-center justify-center gap-2\">\n                {page > 1 && (\n                  <Link\n                    href={`/dashboard${buildQueryString({ page: String(page - 1), sort, order, folderId: folderId || undefined })}`}\n                    className=\"px-4 py-2 text-sm bg-white border border-gray-300 rounded-lg hover:bg-gray-50\"\n                  >\n                    Previous\n                  </Link>\n                )}\n\n                <span className=\"px-4 py-2 text-sm text-gray-600\">\n                  Page {page} of {totalPages}\n                </span>\n\n                {page < totalPages && (\n                  <Link\n                    href={`/dashboard${buildQueryString({ page: String(page + 1), sort, order, folderId: folderId || undefined })}`}\n                    className=\"px-4 py-2 text-sm bg-white border border-gray-300 rounded-lg hover:bg-gray-50\"\n                  >\n                    Next\n                  </Link>\n                )}\n              </div>\n            )}\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/(dashboard)/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/(dashboard)/qr/[id]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/(dashboard)/qr/[id]/qr-edit-form.tsx","messages":[{"ruleId":"complexity","severity":2,"message":"Function 'QREditForm' has a complexity of 16. Maximum allowed is 10.","line":58,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":58,"endColumn":27},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":236,"column":15,"nodeType":"JSXOpeningElement","endLine":240,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect, useSyncExternalStore } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport Link from \"next/link\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { TagInput } from \"@/components/tag-input\";\nimport QRCode from \"qrcode\";\nimport { useToast } from \"@/components/ui/toast\";\nimport { getApiErrorMessage, getApiFieldError } from \"@/lib/errors\";\n\ninterface QRCodeData {\n  id: string;\n  shortCode: string;\n  shortUrl: string;\n  destinationUrl: string;\n  name: string | null;\n  folderId: string | null;\n  isActive: boolean;\n  scanCount: number;\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface Folder {\n  id: string;\n  name: string;\n}\n\ninterface QREditFormProps {\n  qrCode: QRCodeData;\n  folders: Folder[];\n}\n\n// QR code store for managing async generation\nfunction createQRStore() {\n  let snapshot = { dataUrl: \"\", svgString: \"\" };\n  const listeners = new Set<() => void>();\n\n  return {\n    getSnapshot: () => snapshot,\n    subscribe: (listener: () => void) => {\n      listeners.add(listener);\n      return () => listeners.delete(listener);\n    },\n    setData: (png: string, svg: string) => {\n      if (snapshot.dataUrl !== png || snapshot.svgString !== svg) {\n        snapshot = { dataUrl: png, svgString: svg };\n        listeners.forEach((l) => l());\n      }\n    },\n  };\n}\n\nconst qrStore = createQRStore();\n\nexport function QREditForm({ qrCode, folders }: QREditFormProps) {\n  const router = useRouter();\n  const toast = useToast();\n  const [destinationUrl, setDestinationUrl] = useState(qrCode.destinationUrl);\n  const [name, setName] = useState(qrCode.name || \"\");\n  const [folderId, setFolderId] = useState(qrCode.folderId || \"\");\n  const [isActive, setIsActive] = useState(qrCode.isActive);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isSaving, setIsSaving] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n  const [fieldErrors, setFieldErrors] = useState<{\n    destinationUrl?: string;\n    name?: string;\n    folderId?: string;\n  }>({});\n  const [copied, setCopied] = useState(false);\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n\n  const qrData = useSyncExternalStore(qrStore.subscribe, qrStore.getSnapshot, qrStore.getSnapshot);\n\n  // Generate QR code preview on mount\n  useEffect(() => {\n    const generateQR = async () => {\n      try {\n        const [pngUrl, svgStr] = await Promise.all([\n          QRCode.toDataURL(qrCode.shortUrl, {\n            width: 256,\n            margin: 2,\n            errorCorrectionLevel: \"M\",\n          }),\n          QRCode.toString(qrCode.shortUrl, {\n            type: \"svg\",\n            margin: 2,\n            errorCorrectionLevel: \"M\",\n          }),\n        ]);\n        qrStore.setData(pngUrl, svgStr);\n      } catch (err) {\n        console.error(\"Failed to generate QR code:\", err);\n      }\n    };\n\n    generateQR();\n  }, [qrCode.shortUrl]);\n\n  const handleSave = async () => {\n    setError(null);\n    setSuccess(null);\n    setFieldErrors({});\n    setIsSaving(true);\n\n    try {\n      const response = await fetch(`/api/qr/${qrCode.id}`, {\n        method: \"PATCH\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          destinationUrl,\n          name: name || null,\n          folderId: folderId || null,\n          isActive,\n          }),\n      });\n\n      const data = (await response.json().catch(() => null)) as unknown;\n\n      if (!response.ok) {\n        const message = getApiErrorMessage(data) || \"Failed to update QR code\";\n        setError(message);\n        setFieldErrors({\n          destinationUrl: getApiFieldError(data, \"destinationUrl\") || undefined,\n          name: getApiFieldError(data, \"name\") || undefined,\n          folderId: getApiFieldError(data, \"folderId\") || undefined,\n        });\n        toast.error(message);\n        return;\n      }\n\n      setSuccess(\"QR code updated successfully\");\n      toast.success(\"QR code updated\");\n      setTimeout(() => setSuccess(null), 3000);\n      router.refresh();\n    } catch {\n      setError(\"An unexpected error occurred\");\n      toast.error(\"An unexpected error occurred\");\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleDelete = async () => {\n    setIsLoading(true);\n\n    try {\n      const response = await fetch(`/api/qr/${qrCode.id}`, {\n        method: \"DELETE\",\n      });\n\n      if (!response.ok) {\n        const data = (await response.json().catch(() => null)) as unknown;\n        const message = getApiErrorMessage(data) || \"Failed to delete QR code\";\n        setError(message);\n        toast.error(message);\n        setShowDeleteConfirm(false);\n        return;\n      }\n\n      toast.success(\"QR code deleted\");\n      router.push(\"/dashboard\");\n      router.refresh();\n    } catch {\n      setError(\"An unexpected error occurred\");\n      toast.error(\"An unexpected error occurred\");\n      setShowDeleteConfirm(false);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleCopyUrl = async () => {\n    try {\n      await navigator.clipboard.writeText(qrCode.shortUrl);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    } catch (err) {\n      console.error(\"Failed to copy:\", err);\n    }\n  };\n\n  const handleDownload = (format: \"png\" | \"svg\") => {\n    const timestamp = Date.now();\n    const filename = `qr-code-${qrCode.shortCode}-${timestamp}.${format}`;\n\n    if (format === \"png\" && qrData.dataUrl) {\n      const link = document.createElement(\"a\");\n      link.download = filename;\n      link.href = qrData.dataUrl;\n      link.click();\n    } else if (format === \"svg\" && qrData.svgString) {\n      const blob = new Blob([qrData.svgString], { type: \"image/svg+xml\" });\n      const url = URL.createObjectURL(blob);\n      const link = document.createElement(\"a\");\n      link.download = filename;\n      link.href = url;\n      link.click();\n      URL.revokeObjectURL(url);\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString(\"en-US\", {\n      year: \"numeric\",\n      month: \"long\",\n      day: \"numeric\",\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n    });\n  };\n\n  return (\n    <div>\n      <div className=\"mb-6\">\n        <Link\n          href=\"/dashboard\"\n          className=\"text-sm text-gray-500 hover:text-gray-700 flex items-center gap-1\"\n        >\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\n          </svg>\n          Back to Dashboard\n        </Link>\n      </div>\n\n      <div className=\"grid gap-6 lg:grid-cols-3\">\n        {/* Left column - QR code preview */}\n        <div className=\"lg:col-span-1\">\n          <div className=\"bg-white rounded-lg border border-gray-200 p-6 sticky top-6\">\n            {qrData.dataUrl ? (\n              <img\n                src={qrData.dataUrl}\n                alt=\"QR Code\"\n                className=\"w-full aspect-square border rounded-lg mb-4\"\n              />\n            ) : (\n              <div className=\"w-full aspect-square bg-gray-100 rounded-lg mb-4 flex items-center justify-center\">\n                <span className=\"text-gray-400\">Loading...</span>\n              </div>\n            )}\n\n            <div className=\"mb-4\">\n              <p className=\"text-xs text-gray-500 mb-1\">Short URL</p>\n              <div className=\"flex items-center gap-2\">\n                <code className=\"text-sm font-mono text-blue-600 bg-blue-50 px-2 py-1 rounded flex-1 truncate\">\n                  {qrCode.shortUrl}\n                </code>\n                <button\n                  onClick={handleCopyUrl}\n                  className=\"p-1.5 text-gray-400 hover:text-gray-600 flex-shrink-0\"\n                  title=\"Copy URL\"\n                >\n                  {copied ? (\n                    <svg className=\"w-4 h-4 text-green-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                    </svg>\n                  ) : (\n                    <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\" />\n                    </svg>\n                  )}\n                </button>\n              </div>\n            </div>\n\n            <div className=\"flex gap-2\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"flex-1\"\n                onClick={() => handleDownload(\"png\")}\n                disabled={!qrData.dataUrl}\n              >\n                PNG\n              </Button>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"flex-1\"\n                onClick={() => handleDownload(\"svg\")}\n                disabled={!qrData.svgString}\n              >\n                SVG\n              </Button>\n            </div>\n\n            <div className=\"mt-4 pt-4 border-t border-gray-100 text-sm text-gray-500\">\n              <div className=\"flex justify-between mb-1\">\n                <span>Total Scans</span>\n                <span className=\"font-medium text-gray-900\">{qrCode.scanCount}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span>Created</span>\n                <span>{formatDate(qrCode.createdAt)}</span>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Right column - Edit form */}\n        <div className=\"lg:col-span-2\">\n          <div className=\"bg-white rounded-lg border border-gray-200 p-6\">\n            <h1 className=\"text-2xl font-bold text-gray-900 mb-6\">\n              Edit QR Code\n            </h1>\n\n            {error && (\n              <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm\">\n                {error}\n              </div>\n            )}\n\n            {success && (\n              <div className=\"mb-4 p-3 bg-green-50 border border-green-200 rounded-md text-green-700 text-sm\">\n                {success}\n              </div>\n            )}\n\n            <div className=\"space-y-4\">\n              <div>\n                <label\n                  htmlFor=\"destinationUrl\"\n                  className=\"block text-sm font-medium text-gray-700 mb-1\"\n                >\n                  Destination URL\n                </label>\n                <Input\n                  id=\"destinationUrl\"\n                  type=\"url\"\n                  value={destinationUrl}\n                  onChange={(e) => setDestinationUrl(e.target.value)}\n                  placeholder=\"https://example.com\"\n                  disabled={isSaving}\n                  className={fieldErrors.destinationUrl ? \"border-red-500\" : \"\"}\n                />\n                {fieldErrors.destinationUrl && (\n                  <p className=\"mt-1 text-sm text-red-600\">\n                    {fieldErrors.destinationUrl}\n                  </p>\n                )}\n                <p className=\"mt-1 text-xs text-gray-500\">\n                  Change where this QR code redirects to\n                </p>\n              </div>\n\n              <div>\n                <label\n                  htmlFor=\"name\"\n                  className=\"block text-sm font-medium text-gray-700 mb-1\"\n                >\n                  Name\n                </label>\n                <Input\n                  id=\"name\"\n                  type=\"text\"\n                  value={name}\n                  onChange={(e) => setName(e.target.value)}\n                  placeholder=\"My QR Code\"\n                  disabled={isSaving}\n                  className={fieldErrors.name ? \"border-red-500\" : \"\"}\n                />\n                {fieldErrors.name && (\n                  <p className=\"mt-1 text-sm text-red-600\">\n                    {fieldErrors.name}\n                  </p>\n                )}\n              </div>\n\n              {folders.length > 0 && (\n                <div>\n                  <label\n                    htmlFor=\"folder\"\n                    className=\"block text-sm font-medium text-gray-700 mb-1\"\n                  >\n                    Folder\n                  </label>\n                  <select\n                    id=\"folder\"\n                    value={folderId}\n                    onChange={(e) => setFolderId(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    disabled={isSaving}\n                  >\n                    <option value=\"\">No folder</option>\n                    {folders.map((folder) => (\n                      <option key={folder.id} value={folder.id}>\n                        {folder.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n              )}\n\n              <TagInput qrCodeId={qrCode.id} />\n\n              <div>\n                <label className=\"flex items-center gap-3 cursor-pointer\">\n                  <div className=\"relative\">\n                    <input\n                      type=\"checkbox\"\n                      checked={isActive}\n                      onChange={(e) => setIsActive(e.target.checked)}\n                      className=\"sr-only peer\"\n                      disabled={isSaving}\n                    />\n                    <div className=\"w-11 h-6 bg-gray-200 rounded-full peer peer-checked:bg-blue-600 transition-colors\"></div>\n                    <div className=\"absolute left-1 top-1 w-4 h-4 bg-white rounded-full peer-checked:translate-x-5 transition-transform\"></div>\n                  </div>\n                  <span className=\"text-sm font-medium text-gray-700\">\n                    Active\n                  </span>\n                </label>\n                <p className=\"mt-1 text-xs text-gray-500 ml-14\">\n                  When disabled, scanning this QR code will show a &quot;gone&quot; page\n                </p>\n              </div>\n            </div>\n\n            <div className=\"mt-6 pt-6 border-t border-gray-200 flex items-center justify-between\">\n              <Button\n                variant=\"outline\"\n                onClick={() => setShowDeleteConfirm(true)}\n                disabled={isSaving || isLoading}\n                className=\"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-200\"\n              >\n                Delete QR Code\n              </Button>\n\n              <Button\n                variant=\"primary\"\n                onClick={handleSave}\n                disabled={isSaving}\n              >\n                {isSaving ? \"Saving...\" : \"Save Changes\"}\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Delete confirmation modal */}\n      {showDeleteConfirm && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\n          <div className=\"bg-white rounded-lg shadow-xl w-full max-w-md mx-4 p-6\">\n            <h3 className=\"text-lg font-bold text-gray-900 mb-2\">\n              Delete QR Code?\n            </h3>\n            <p className=\"text-gray-600 mb-6\">\n              This action cannot be undone. The short URL will stop working immediately.\n            </p>\n            <div className=\"flex gap-3 justify-end\">\n              <Button\n                variant=\"outline\"\n                onClick={() => setShowDeleteConfirm(false)}\n                disabled={isLoading}\n              >\n                Cancel\n              </Button>\n              <Button\n                variant=\"primary\"\n                onClick={handleDelete}\n                disabled={isLoading}\n                className=\"bg-red-600 hover:bg-red-700\"\n              >\n                {isLoading ? \"Deleting...\" : \"Delete\"}\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/(dashboard)/qr/new/page.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":200,"column":17,"nodeType":"JSXOpeningElement","endLine":204,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect, useSyncExternalStore } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport Link from \"next/link\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport QRCode from \"qrcode\";\n\n// QR code store for managing async generation\nfunction createQRStore() {\n  let snapshot = { dataUrl: \"\", svgString: \"\" };\n  const listeners = new Set<() => void>();\n\n  return {\n    getSnapshot: () => snapshot,\n    subscribe: (listener: () => void) => {\n      listeners.add(listener);\n      return () => listeners.delete(listener);\n    },\n    setData: (png: string, svg: string) => {\n      if (snapshot.dataUrl !== png || snapshot.svgString !== svg) {\n        snapshot = { dataUrl: png, svgString: svg };\n        listeners.forEach((l) => l());\n      }\n    },\n  };\n}\n\nconst qrStore = createQRStore();\n\ninterface Folder {\n  id: string;\n  name: string;\n}\n\nexport default function CreateQRPage() {\n  const router = useRouter();\n  const [destinationUrl, setDestinationUrl] = useState(\"\");\n  const [name, setName] = useState(\"\");\n  const [folderId, setFolderId] = useState(\"\");\n  const [folders, setFolders] = useState<Folder[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [createdQR, setCreatedQR] = useState<{\n    id: string;\n    shortCode: string;\n    shortUrl: string;\n  } | null>(null);\n  const [copied, setCopied] = useState(false);\n\n  const qrData = useSyncExternalStore(qrStore.subscribe, qrStore.getSnapshot, qrStore.getSnapshot);\n\n  // Load folders on mount\n  useEffect(() => {\n    const loadFolders = async () => {\n      try {\n        const response = await fetch(\"/api/folders\");\n        if (response.ok) {\n          const data = await response.json();\n          setFolders(data.data || []);\n        }\n      } catch (err) {\n        console.error(\"Failed to load folders:\", err);\n      }\n    };\n    loadFolders();\n  }, []);\n\n  // Generate QR code preview when URL changes\n  useEffect(() => {\n    if (!createdQR?.shortUrl) {\n      qrStore.setData(\"\", \"\");\n      return;\n    }\n\n    const generateQR = async () => {\n      try {\n        const [pngUrl, svgStr] = await Promise.all([\n          QRCode.toDataURL(createdQR.shortUrl, {\n            width: 256,\n            margin: 2,\n            errorCorrectionLevel: \"M\",\n          }),\n          QRCode.toString(createdQR.shortUrl, {\n            type: \"svg\",\n            margin: 2,\n            errorCorrectionLevel: \"M\",\n          }),\n        ]);\n        qrStore.setData(pngUrl, svgStr);\n      } catch (err) {\n        console.error(\"Failed to generate QR code:\", err);\n      }\n    };\n\n    generateQR();\n  }, [createdQR?.shortUrl]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n    setIsLoading(true);\n\n    try {\n      const response = await fetch(\"/api/qr\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          destinationUrl,\n          name: name || undefined,\n          folderId: folderId || undefined,\n        }),\n      });\n\n      const data = await response.json();\n\n      if (!response.ok) {\n        setError(data.error || \"Failed to create QR code\");\n        return;\n      }\n\n      setCreatedQR({\n        id: data.id,\n        shortCode: data.shortCode,\n        shortUrl: data.shortUrl,\n      });\n    } catch {\n      setError(\"An unexpected error occurred\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleCopyUrl = async () => {\n    if (!createdQR?.shortUrl) return;\n    try {\n      await navigator.clipboard.writeText(createdQR.shortUrl);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    } catch (err) {\n      console.error(\"Failed to copy:\", err);\n    }\n  };\n\n  const handleDownload = (format: \"png\" | \"svg\") => {\n    if (!createdQR) return;\n\n    const timestamp = Date.now();\n    const filename = `qr-code-${createdQR.shortCode}-${timestamp}.${format}`;\n\n    if (format === \"png\" && qrData.dataUrl) {\n      const link = document.createElement(\"a\");\n      link.download = filename;\n      link.href = qrData.dataUrl;\n      link.click();\n    } else if (format === \"svg\" && qrData.svgString) {\n      const blob = new Blob([qrData.svgString], { type: \"image/svg+xml\" });\n      const url = URL.createObjectURL(blob);\n      const link = document.createElement(\"a\");\n      link.download = filename;\n      link.href = url;\n      link.click();\n      URL.revokeObjectURL(url);\n    }\n  };\n\n  const handleCreateAnother = () => {\n    setDestinationUrl(\"\");\n    setName(\"\");\n    setFolderId(\"\");\n    setCreatedQR(null);\n    qrStore.setData(\"\", \"\");\n  };\n\n  return (\n    <div className=\"max-w-2xl mx-auto\">\n      <div className=\"mb-6\">\n        <Link\n          href=\"/dashboard\"\n          className=\"text-sm text-gray-500 hover:text-gray-700 flex items-center gap-1\"\n        >\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\n          </svg>\n          Back to Dashboard\n        </Link>\n      </div>\n\n      <div className=\"bg-white rounded-lg border border-gray-200 p-6\">\n        <h1 className=\"text-2xl font-bold text-gray-900 mb-6\">\n          {createdQR ? \"QR Code Created!\" : \"Create New QR Code\"}\n        </h1>\n\n        {createdQR ? (\n          // Success state with QR preview\n          <div className=\"text-center\">\n            {qrData.dataUrl && (\n              <div className=\"mb-6\">\n                <img\n                  src={qrData.dataUrl}\n                  alt=\"Generated QR Code\"\n                  className=\"mx-auto w-64 h-64 border rounded-lg\"\n                />\n              </div>\n            )}\n\n            <div className=\"mb-6\">\n              <p className=\"text-sm text-gray-500 mb-2\">Your short URL:</p>\n              <div className=\"flex items-center justify-center gap-2\">\n                <code className=\"text-lg font-mono text-blue-600 bg-blue-50 px-4 py-2 rounded\">\n                  {createdQR.shortUrl}\n                </code>\n                <button\n                  onClick={handleCopyUrl}\n                  className=\"p-2 text-gray-400 hover:text-gray-600\"\n                  title=\"Copy URL\"\n                >\n                  {copied ? (\n                    <svg className=\"w-5 h-5 text-green-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                    </svg>\n                  ) : (\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\" />\n                    </svg>\n                  )}\n                </button>\n              </div>\n            </div>\n\n            <div className=\"flex gap-3 justify-center mb-6\">\n              <Button\n                variant=\"outline\"\n                onClick={() => handleDownload(\"png\")}\n                disabled={!qrData.dataUrl}\n              >\n                Download PNG\n              </Button>\n              <Button\n                variant=\"outline\"\n                onClick={() => handleDownload(\"svg\")}\n                disabled={!qrData.svgString}\n              >\n                Download SVG\n              </Button>\n            </div>\n\n            <div className=\"flex gap-3 justify-center\">\n              <Button variant=\"outline\" onClick={handleCreateAnother}>\n                Create Another\n              </Button>\n              <Button\n                variant=\"primary\"\n                onClick={() => router.push(`/qr/${createdQR.id}`)}\n              >\n                View Details\n              </Button>\n            </div>\n          </div>\n        ) : (\n          // Creation form\n          <form onSubmit={handleSubmit}>\n            {error && (\n              <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm\">\n                {error}\n              </div>\n            )}\n\n            <div className=\"space-y-4\">\n              <div>\n                <label\n                  htmlFor=\"destinationUrl\"\n                  className=\"block text-sm font-medium text-gray-700 mb-1\"\n                >\n                  Destination URL <span className=\"text-red-500\">*</span>\n                </label>\n                <Input\n                  id=\"destinationUrl\"\n                  type=\"url\"\n                  value={destinationUrl}\n                  onChange={(e) => setDestinationUrl(e.target.value)}\n                  placeholder=\"https://example.com\"\n                  required\n                  disabled={isLoading}\n                />\n                <p className=\"mt-1 text-xs text-gray-500\">\n                  The URL where your QR code will redirect to\n                </p>\n              </div>\n\n              <div>\n                <label\n                  htmlFor=\"name\"\n                  className=\"block text-sm font-medium text-gray-700 mb-1\"\n                >\n                  Name <span className=\"text-gray-400\">(optional)</span>\n                </label>\n                <Input\n                  id=\"name\"\n                  type=\"text\"\n                  value={name}\n                  onChange={(e) => setName(e.target.value)}\n                  placeholder=\"My QR Code\"\n                  disabled={isLoading}\n                />\n                <p className=\"mt-1 text-xs text-gray-500\">\n                  A friendly name to help you identify this QR code\n                </p>\n              </div>\n\n              {folders.length > 0 && (\n                <div>\n                  <label\n                    htmlFor=\"folder\"\n                    className=\"block text-sm font-medium text-gray-700 mb-1\"\n                  >\n                    Folder <span className=\"text-gray-400\">(optional)</span>\n                  </label>\n                  <select\n                    id=\"folder\"\n                    value={folderId}\n                    onChange={(e) => setFolderId(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    disabled={isLoading}\n                  >\n                    <option value=\"\">No folder</option>\n                    {folders.map((folder) => (\n                      <option key={folder.id} value={folder.id}>\n                        {folder.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n              )}\n            </div>\n\n            <div className=\"mt-6 flex gap-3 justify-end\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => router.push(\"/dashboard\")}\n                disabled={isLoading}\n              >\n                Cancel\n              </Button>\n              <Button type=\"submit\" variant=\"primary\" disabled={isLoading}>\n                {isLoading ? \"Creating...\" : \"Create QR Code\"}\n              </Button>\n            </div>\n          </form>\n        )}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/(dashboard)/settings/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/(dashboard)/settings/settings-form.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/(marketing)/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/(marketing)/pricing/page.tsx","messages":[{"ruleId":"complexity","severity":2,"message":"Arrow function has a complexity of 11. Maximum allowed is 10.","line":101,"column":29,"nodeType":"ArrowFunctionExpression","messageId":"complex","endLine":101,"endColumn":31}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport Link from \"next/link\";\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\n\nconst tiers = [\n  {\n    name: \"Free\",\n    description: \"Static QR codes forever\",\n    monthlyPrice: 0,\n    annualPrice: 0,\n    features: [\n      \"Unlimited static QR codes\",\n      \"PNG and SVG downloads\",\n      \"No account required\",\n      \"Never expires\",\n    ],\n    cta: \"Use Now\",\n    ctaLink: \"/\",\n    highlighted: false,\n  },\n  {\n    name: \"Pro\",\n    description: \"For individuals and small teams\",\n    monthlyPrice: 5,\n    annualPrice: 36,\n    features: [\n      \"Up to 10 dynamic QR codes\",\n      \"Change destination anytime\",\n      \"Basic scan analytics\",\n      \"Folders for organization\",\n      \"Never expires\",\n    ],\n    cta: \"Sign Up\",\n    ctaLink: \"/signup?plan=pro\",\n    highlighted: true,\n  },\n  {\n    name: \"Business\",\n    description: \"For growing businesses\",\n    monthlyPrice: 15,\n    annualPrice: 120,\n    features: [\n      \"Unlimited dynamic QR codes\",\n      \"Change destination anytime\",\n      \"Advanced analytics with CSV export\",\n      \"Folders and tags\",\n      \"Priority support\",\n      \"Never expires\",\n    ],\n    cta: \"Sign Up\",\n    ctaLink: \"/signup?plan=business\",\n    highlighted: false,\n  },\n];\n\nexport default function PricingPage() {\n  const [isAnnual, setIsAnnual] = useState(false);\n\n  return (\n    <div className=\"bg-white\">\n      {/* Header */}\n      <div className=\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-16 sm:py-24\">\n        <div className=\"text-center\">\n          <h1 className=\"text-4xl sm:text-5xl font-bold text-gray-900 tracking-tight\">\n            Simple, honest pricing\n          </h1>\n          <p className=\"mt-4 text-xl text-gray-600 max-w-2xl mx-auto\">\n            No hidden fees. No hostage codes. Your QR codes work forever.\n          </p>\n        </div>\n\n        {/* Billing Toggle */}\n        <div className=\"mt-12 flex justify-center items-center gap-4\">\n          <span className={`text-sm ${!isAnnual ? \"text-gray-900 font-medium\" : \"text-gray-500\"}`}>\n            Monthly\n          </span>\n          <button\n            onClick={() => setIsAnnual(!isAnnual)}\n            className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${\n              isAnnual ? \"bg-gray-900\" : \"bg-gray-200\"\n            }`}\n            role=\"switch\"\n            aria-checked={isAnnual}\n          >\n            <span\n              className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${\n                isAnnual ? \"translate-x-6\" : \"translate-x-1\"\n              }`}\n            />\n          </button>\n          <span className={`text-sm ${isAnnual ? \"text-gray-900 font-medium\" : \"text-gray-500\"}`}>\n            Annual\n            <span className=\"ml-1 text-green-600 font-medium\">(Save 40%)</span>\n          </span>\n        </div>\n\n        {/* Pricing Cards */}\n        <div className=\"mt-12 grid md:grid-cols-3 gap-8\">\n          {tiers.map((tier) => {\n            const price = isAnnual ? tier.annualPrice : tier.monthlyPrice;\n            const period = isAnnual ? \"/year\" : \"/month\";\n\n            return (\n              <div\n                key={tier.name}\n                className={`rounded-2xl p-8 ${\n                  tier.highlighted\n                    ? \"bg-gray-900 text-white ring-4 ring-gray-900\"\n                    : \"bg-white border border-gray-200\"\n                }`}\n              >\n                <h3\n                  className={`text-lg font-semibold ${\n                    tier.highlighted ? \"text-white\" : \"text-gray-900\"\n                  }`}\n                >\n                  {tier.name}\n                </h3>\n                <p\n                  className={`mt-1 text-sm ${tier.highlighted ? \"text-gray-300\" : \"text-gray-500\"}`}\n                >\n                  {tier.description}\n                </p>\n                <div className=\"mt-6\">\n                  <span\n                    className={`text-4xl font-bold ${\n                      tier.highlighted ? \"text-white\" : \"text-gray-900\"\n                    }`}\n                  >\n                    ${price}\n                  </span>\n                  {price > 0 && (\n                    <span className={tier.highlighted ? \"text-gray-300\" : \"text-gray-500\"}>\n                      {period}\n                    </span>\n                  )}\n                </div>\n\n                <ul className=\"mt-8 space-y-4\">\n                  {tier.features.map((feature) => (\n                    <li key={feature} className=\"flex items-start\">\n                      <span className={`mr-2 ${tier.highlighted ? \"text-green-400\" : \"text-green-500\"}`}>\n                        &#10003;\n                      </span>\n                      <span className={tier.highlighted ? \"text-gray-200\" : \"text-gray-600\"}>\n                        {feature}\n                      </span>\n                    </li>\n                  ))}\n                </ul>\n\n                <div className=\"mt-8\">\n                  <Link href={tier.ctaLink}>\n                    <Button\n                      variant={tier.highlighted ? \"outline\" : \"primary\"}\n                      className={`w-full ${\n                        tier.highlighted\n                          ? \"bg-white text-gray-900 hover:bg-gray-100 border-white\"\n                          : \"\"\n                      }`}\n                    >\n                      {tier.cta}\n                    </Button>\n                  </Link>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n\n        {/* FAQ / Trust Section */}\n        <div className=\"mt-24\">\n          <h2 className=\"text-2xl font-bold text-gray-900 text-center mb-12\">\n            Frequently Asked Questions\n          </h2>\n          <div className=\"grid md:grid-cols-2 gap-8 max-w-4xl mx-auto\">\n            <div>\n              <h3 className=\"font-semibold text-gray-900\">What happens if I cancel?</h3>\n              <p className=\"mt-2 text-gray-600\">\n                Your dynamic QR codes continue to work. You just won&apos;t be able to edit them or\n                view new analytics. We never hold your printed materials hostage.\n              </p>\n            </div>\n            <div>\n              <h3 className=\"font-semibold text-gray-900\">Do static QR codes really stay free?</h3>\n              <p className=\"mt-2 text-gray-600\">\n                Yes, forever. Static QR codes are generated entirely in your browser. We\n                don&apos;t host them, so there&apos;s no cost to us.\n              </p>\n            </div>\n            <div>\n              <h3 className=\"font-semibold text-gray-900\">Can I upgrade or downgrade anytime?</h3>\n              <p className=\"mt-2 text-gray-600\">\n                Absolutely. Upgrades take effect immediately, and downgrades happen at the end of\n                your billing cycle.\n              </p>\n            </div>\n            <div>\n              <h3 className=\"font-semibold text-gray-900\">What payment methods do you accept?</h3>\n              <p className=\"mt-2 text-gray-600\">\n                We accept all major credit cards through Stripe. Your payment information is never\n                stored on our servers.\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/api/auth/[...nextauth]/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/api/auth/signup/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/api/folders/[id]/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/api/folders/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/api/qr/[id]/analytics/export/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/api/qr/[id]/analytics/route.ts","messages":[{"ruleId":"complexity","severity":2,"message":"Async function 'GET' has a complexity of 11. Maximum allowed is 10.","line":16,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":16,"endColumn":26}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from \"next/server\";\nimport { auth } from \"@/lib/auth\";\nimport { db } from \"@/lib/db\";\nimport { qrCodes, scanEvents } from \"@/lib/db/schema\";\nimport { eq, sql } from \"drizzle-orm\";\nimport {\n  buildScanEventsWhereClause,\n  parseAnalyticsDateRange,\n} from \"@/lib/analytics\";\n\ninterface RouteContext {\n  params: Promise<{ id: string }>;\n}\n\n// GET /api/qr/[id]/analytics - Get analytics data for a QR code\nexport async function GET(request: NextRequest, context: RouteContext) {\n  const session = await auth();\n\n  if (!session?.user?.id) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  const { id } = await context.params;\n\n  // Validate UUID format\n  const uuidRegex =\n    /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\n  if (!uuidRegex.test(id)) {\n    return NextResponse.json({ error: \"Invalid QR code ID\" }, { status: 400 });\n  }\n\n  const qrCode = await db.query.qrCodes.findFirst({\n    where: eq(qrCodes.id, id),\n    columns: {\n      id: true,\n      userId: true,\n    },\n  });\n\n  if (!qrCode) {\n    return NextResponse.json({ error: \"QR code not found\" }, { status: 404 });\n  }\n\n  if (qrCode.userId !== session.user.id) {\n    return NextResponse.json({ error: \"Forbidden\" }, { status: 403 });\n  }\n\n  const { searchParams } = new URL(request.url);\n  const fromParam = searchParams.get(\"from\");\n  const toParam = searchParams.get(\"to\");\n\n  let dateRange;\n  try {\n    dateRange = parseAnalyticsDateRange(fromParam, toParam);\n  } catch (error) {\n    const message = error instanceof Error ? error.message : \"Invalid query params\";\n    return NextResponse.json({ error: message }, { status: 400 });\n  }\n\n  const whereConditions = buildScanEventsWhereClause(id, dateRange);\n  const whereSql = sql.join(whereConditions, sql` and `);\n\n  const [totalResult, byDayResult, byCountryResult] = await Promise.all([\n    db.execute<{ count: number | string }>(sql`\n      select count(*)::int as count\n      from ${scanEvents}\n      where ${whereSql}\n    `),\n    db.execute<{ date: string; count: number | string }>(sql`\n      select (${scanEvents.scannedAt}::date) as date, count(*)::int as count\n      from ${scanEvents}\n      where ${whereSql}\n      group by (${scanEvents.scannedAt}::date)\n      order by date asc\n    `),\n    db.execute<{ country: string; count: number | string }>(sql`\n      select ${scanEvents.country} as country, count(*)::int as count\n      from ${scanEvents}\n      where ${whereSql} and ${scanEvents.country} is not null\n      group by ${scanEvents.country}\n      order by count desc\n    `),\n  ]);\n\n  const totalScans = Number(totalResult.rows[0]?.count || 0);\n  const scansByDay = byDayResult.rows.map((row) => ({\n    date: String(row.date),\n    count: Number(row.count),\n  }));\n  const scansByCountry = byCountryResult.rows.map((row) => ({\n    country: String(row.country),\n    count: Number(row.count),\n  }));\n\n  return NextResponse.json({\n    totalScans,\n    scansByDay,\n    scansByCountry,\n  });\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/api/qr/[id]/route.ts","messages":[{"ruleId":"complexity","severity":2,"message":"Async function 'PATCH' has a complexity of 17. Maximum allowed is 10.","line":67,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":67,"endColumn":28}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from \"next/server\";\nimport { z } from \"zod\";\nimport { auth } from \"@/lib/auth\";\nimport { db } from \"@/lib/db\";\nimport { qrCodes } from \"@/lib/db/schema\";\nimport { eq, and } from \"drizzle-orm\";\nimport { buildShortUrl, isValidUrl } from \"@/lib/qr\";\nimport { checkUrlSafety } from \"@/lib/safe-browsing\";\n\n// Request body schema for updating a QR code\nconst updateQrSchema = z.object({\n  destinationUrl: z.string().min(1).optional(),\n  name: z.string().max(255).optional().nullable(),\n  folderId: z.string().uuid().optional().nullable(),\n  isActive: z.boolean().optional(),\n});\n\ninterface RouteContext {\n  params: Promise<{ id: string }>;\n}\n\n// GET /api/qr/[id] - Get a single QR code\nexport async function GET(request: NextRequest, context: RouteContext) {\n  const session = await auth();\n\n  if (!session?.user?.id) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  const { id } = await context.params;\n\n  // Validate UUID format\n  const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\n  if (!uuidRegex.test(id)) {\n    return NextResponse.json({ error: \"Invalid QR code ID\" }, { status: 400 });\n  }\n\n  // Find QR code\n  const qrCode = await db.query.qrCodes.findFirst({\n    where: eq(qrCodes.id, id),\n  });\n\n  if (!qrCode) {\n    return NextResponse.json({ error: \"QR code not found\" }, { status: 404 });\n  }\n\n  // Check ownership\n  if (qrCode.userId !== session.user.id) {\n    return NextResponse.json({ error: \"Forbidden\" }, { status: 403 });\n  }\n\n  return NextResponse.json({\n    id: qrCode.id,\n    shortCode: qrCode.shortCode,\n    shortUrl: buildShortUrl(qrCode.shortCode),\n    destinationUrl: qrCode.destinationUrl,\n    name: qrCode.name,\n    folderId: qrCode.folderId,\n    isActive: qrCode.isActive,\n    scanCount: qrCode.scanCount,\n    createdAt: qrCode.createdAt.toISOString(),\n    updatedAt: qrCode.updatedAt.toISOString(),\n  });\n}\n\n// PATCH /api/qr/[id] - Update a QR code\nexport async function PATCH(request: NextRequest, context: RouteContext) {\n  const session = await auth();\n\n  if (!session?.user?.id) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  const { id } = await context.params;\n\n  // Validate UUID format\n  const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\n  if (!uuidRegex.test(id)) {\n    return NextResponse.json({ error: \"Invalid QR code ID\" }, { status: 400 });\n  }\n\n  let body;\n  try {\n    body = await request.json();\n  } catch {\n    return NextResponse.json({ error: \"Invalid JSON body\" }, { status: 400 });\n  }\n\n  // Validate request body\n  const result = updateQrSchema.safeParse(body);\n  if (!result.success) {\n    return NextResponse.json(\n      { error: \"Validation failed\", details: result.error.flatten() },\n      { status: 400 }\n    );\n  }\n\n  const { destinationUrl, name, folderId, isActive } = result.data;\n\n  // Find existing QR code\n  const existingQr = await db.query.qrCodes.findFirst({\n    where: eq(qrCodes.id, id),\n  });\n\n  if (!existingQr) {\n    return NextResponse.json({ error: \"QR code not found\" }, { status: 404 });\n  }\n\n  // Check ownership\n  if (existingQr.userId !== session.user.id) {\n    return NextResponse.json({ error: \"Forbidden\" }, { status: 403 });\n  }\n\n  // Validate destination URL if provided\n  if (destinationUrl !== undefined && !isValidUrl(destinationUrl)) {\n    return NextResponse.json(\n      { error: \"Invalid URL. Must be a valid http or https URL.\" },\n      { status: 400 }\n    );\n  }\n\n  if (destinationUrl !== undefined) {\n    const safety = await checkUrlSafety(destinationUrl);\n    if (!safety.safe) {\n      return NextResponse.json(\n        {\n          error:\n            \"Destination URL was rejected because it appears unsafe (Google Safe Browsing).\",\n        },\n        { status: 400 }\n      );\n    }\n  }\n\n  // Build update object\n  const updateData: Partial<typeof qrCodes.$inferInsert> = {\n    updatedAt: new Date(),\n  };\n\n  if (destinationUrl !== undefined) {\n    updateData.destinationUrl = destinationUrl;\n  }\n  if (name !== undefined) {\n    updateData.name = name;\n  }\n  if (folderId !== undefined) {\n    updateData.folderId = folderId;\n  }\n  if (isActive !== undefined) {\n    updateData.isActive = isActive;\n  }\n\n  // Update QR code\n  const [updatedQr] = await db\n    .update(qrCodes)\n    .set(updateData)\n    .where(and(eq(qrCodes.id, id), eq(qrCodes.userId, session.user.id)))\n    .returning();\n\n  return NextResponse.json({\n    id: updatedQr.id,\n    shortCode: updatedQr.shortCode,\n    shortUrl: buildShortUrl(updatedQr.shortCode),\n    destinationUrl: updatedQr.destinationUrl,\n    name: updatedQr.name,\n    folderId: updatedQr.folderId,\n    isActive: updatedQr.isActive,\n    scanCount: updatedQr.scanCount,\n    createdAt: updatedQr.createdAt.toISOString(),\n    updatedAt: updatedQr.updatedAt.toISOString(),\n  });\n}\n\n// DELETE /api/qr/[id] - Delete a QR code\nexport async function DELETE(request: NextRequest, context: RouteContext) {\n  const session = await auth();\n\n  if (!session?.user?.id) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  const { id } = await context.params;\n\n  // Validate UUID format\n  const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\n  if (!uuidRegex.test(id)) {\n    return NextResponse.json({ error: \"Invalid QR code ID\" }, { status: 400 });\n  }\n\n  // Find existing QR code\n  const existingQr = await db.query.qrCodes.findFirst({\n    where: eq(qrCodes.id, id),\n  });\n\n  if (!existingQr) {\n    return NextResponse.json({ error: \"QR code not found\" }, { status: 404 });\n  }\n\n  // Check ownership\n  if (existingQr.userId !== session.user.id) {\n    return NextResponse.json({ error: \"Forbidden\" }, { status: 403 });\n  }\n\n  // Delete QR code\n  await db\n    .delete(qrCodes)\n    .where(and(eq(qrCodes.id, id), eq(qrCodes.userId, session.user.id)));\n\n  return new NextResponse(null, { status: 204 });\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/api/qr/[id]/tags/[tagId]/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/api/qr/[id]/tags/route.ts","messages":[{"ruleId":"complexity","severity":2,"message":"Async function 'POST' has a complexity of 11. Maximum allowed is 10.","line":62,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":62,"endColumn":27}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from \"next/server\";\nimport { z } from \"zod\";\nimport { auth } from \"@/lib/auth\";\nimport { db } from \"@/lib/db\";\nimport { qrCodes, qrCodeTags, tags } from \"@/lib/db/schema\";\nimport { eq, and } from \"drizzle-orm\";\n\n// Request body schema for adding a tag\nconst addTagSchema = z.object({\n  tagId: z.string().uuid(\"Invalid tag ID\"),\n});\n\ninterface RouteContext {\n  params: Promise<{ id: string }>;\n}\n\n// GET /api/qr/[id]/tags - List tags for a QR code\nexport async function GET(request: NextRequest, context: RouteContext) {\n  const session = await auth();\n\n  if (!session?.user?.id) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  const { id } = await context.params;\n\n  // Validate UUID format\n  const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\n  if (!uuidRegex.test(id)) {\n    return NextResponse.json({ error: \"Invalid QR code ID\" }, { status: 400 });\n  }\n\n  // Find QR code and verify ownership\n  const qrCode = await db.query.qrCodes.findFirst({\n    where: eq(qrCodes.id, id),\n  });\n\n  if (!qrCode) {\n    return NextResponse.json({ error: \"QR code not found\" }, { status: 404 });\n  }\n\n  if (qrCode.userId !== session.user.id) {\n    return NextResponse.json({ error: \"Forbidden\" }, { status: 403 });\n  }\n\n  // Get tags for this QR code\n  const qrTags = await db\n    .select({\n      id: tags.id,\n      name: tags.name,\n    })\n    .from(qrCodeTags)\n    .innerJoin(tags, eq(qrCodeTags.tagId, tags.id))\n    .where(eq(qrCodeTags.qrCodeId, id));\n\n  return NextResponse.json({\n    data: qrTags,\n  });\n}\n\n// POST /api/qr/[id]/tags - Add a tag to a QR code\nexport async function POST(request: NextRequest, context: RouteContext) {\n  const session = await auth();\n\n  if (!session?.user?.id) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  const { id } = await context.params;\n\n  // Validate UUID format\n  const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\n  if (!uuidRegex.test(id)) {\n    return NextResponse.json({ error: \"Invalid QR code ID\" }, { status: 400 });\n  }\n\n  let body;\n  try {\n    body = await request.json();\n  } catch {\n    return NextResponse.json({ error: \"Invalid JSON body\" }, { status: 400 });\n  }\n\n  // Validate request body\n  const result = addTagSchema.safeParse(body);\n  if (!result.success) {\n    return NextResponse.json(\n      { error: \"Validation failed\", details: result.error.flatten() },\n      { status: 400 }\n    );\n  }\n\n  const { tagId } = result.data;\n\n  // Find QR code and verify ownership\n  const qrCode = await db.query.qrCodes.findFirst({\n    where: eq(qrCodes.id, id),\n  });\n\n  if (!qrCode) {\n    return NextResponse.json({ error: \"QR code not found\" }, { status: 404 });\n  }\n\n  if (qrCode.userId !== session.user.id) {\n    return NextResponse.json({ error: \"Forbidden\" }, { status: 403 });\n  }\n\n  // Verify tag exists and belongs to user\n  const tag = await db.query.tags.findFirst({\n    where: and(eq(tags.id, tagId), eq(tags.userId, session.user.id)),\n  });\n\n  if (!tag) {\n    return NextResponse.json({ error: \"Tag not found\" }, { status: 404 });\n  }\n\n  // Check if tag is already added\n  const existing = await db.query.qrCodeTags.findFirst({\n    where: and(eq(qrCodeTags.qrCodeId, id), eq(qrCodeTags.tagId, tagId)),\n  });\n\n  if (existing) {\n    return NextResponse.json({ error: \"Tag already added to this QR code\" }, { status: 409 });\n  }\n\n  // Add tag to QR code\n  await db.insert(qrCodeTags).values({\n    qrCodeId: id,\n    tagId,\n  });\n\n  return NextResponse.json(\n    {\n      qrCodeId: id,\n      tagId,\n      tagName: tag.name,\n    },\n    { status: 201 }\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/api/qr/route.ts","messages":[{"ruleId":"complexity","severity":2,"message":"Async function 'POST' has a complexity of 14. Maximum allowed is 10.","line":89,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":89,"endColumn":27}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from \"next/server\";\nimport { z } from \"zod\";\nimport { auth } from \"@/lib/auth\";\nimport { db } from \"@/lib/db\";\nimport { qrCodes } from \"@/lib/db/schema\";\nimport { eq, desc, and, sql } from \"drizzle-orm\";\nimport { generateUniqueShortCode, buildShortUrl, isValidUrl } from \"@/lib/qr\";\nimport {\n  requireSubscription,\n  checkQrLimit,\n  SubscriptionError,\n} from \"@/lib/subscription\";\nimport { checkUrlSafety } from \"@/lib/safe-browsing\";\n\n// Request body schema for creating a QR code\nconst createQrSchema = z.object({\n  destinationUrl: z.string().min(1, \"Destination URL is required\"),\n  name: z.string().max(255).optional(),\n  folderId: z.string().uuid().optional().nullable(),\n});\n\n// GET /api/qr - List user's QR codes with pagination\nexport async function GET(request: NextRequest) {\n  const session = await auth();\n\n  if (!session?.user?.id) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  const { searchParams } = new URL(request.url);\n  const page = Math.max(1, parseInt(searchParams.get(\"page\") || \"1\", 10));\n  const limit = Math.min(100, Math.max(1, parseInt(searchParams.get(\"limit\") || \"20\", 10)));\n  const folderId = searchParams.get(\"folderId\");\n  const offset = (page - 1) * limit;\n\n  // Build where clause\n  const whereConditions = [eq(qrCodes.userId, session.user.id)];\n  if (folderId) {\n    if (folderId === \"null\") {\n      whereConditions.push(sql`${qrCodes.folderId} IS NULL`);\n    } else {\n      whereConditions.push(eq(qrCodes.folderId, folderId));\n    }\n  }\n\n  // Get QR codes\n  const codes = await db\n    .select()\n    .from(qrCodes)\n    .where(and(...whereConditions))\n    .orderBy(desc(qrCodes.createdAt))\n    .limit(limit)\n    .offset(offset);\n\n  // Get total count for pagination\n  const countResult = await db\n    .select({ count: sql<number>`count(*)` })\n    .from(qrCodes)\n    .where(and(...whereConditions));\n\n  const total = Number(countResult[0]?.count || 0);\n\n  // Transform response to include short URL\n  const data = codes.map((code) => ({\n    id: code.id,\n    shortCode: code.shortCode,\n    shortUrl: buildShortUrl(code.shortCode),\n    destinationUrl: code.destinationUrl,\n    name: code.name,\n    folderId: code.folderId,\n    isActive: code.isActive,\n    scanCount: code.scanCount,\n    createdAt: code.createdAt.toISOString(),\n    updatedAt: code.updatedAt.toISOString(),\n  }));\n\n  return NextResponse.json({\n    data,\n    pagination: {\n      page,\n      limit,\n      total,\n      totalPages: Math.ceil(total / limit),\n    },\n  });\n}\n\n// POST /api/qr - Create a new QR code\nexport async function POST(request: NextRequest) {\n  const session = await auth();\n\n  if (!session?.user?.id) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  // Check subscription status\n  let subscription;\n  try {\n    subscription = await requireSubscription(session.user.id);\n  } catch (error) {\n    if (error instanceof SubscriptionError) {\n      return NextResponse.json(\n        { error: error.message, code: error.code },\n        { status: 403 }\n      );\n    }\n    throw error;\n  }\n\n  // Check QR code limit for the plan\n  try {\n    await checkQrLimit(session.user.id, subscription.plan);\n  } catch (error) {\n    if (error instanceof SubscriptionError) {\n      return NextResponse.json(\n        { error: error.message, code: error.code },\n        { status: 403 }\n      );\n    }\n    throw error;\n  }\n\n  let body;\n  try {\n    body = await request.json();\n  } catch {\n    return NextResponse.json({ error: \"Invalid JSON body\" }, { status: 400 });\n  }\n\n  // Validate request body\n  const result = createQrSchema.safeParse(body);\n  if (!result.success) {\n    return NextResponse.json(\n      { error: \"Validation failed\", details: result.error.flatten() },\n      { status: 400 }\n    );\n  }\n\n  const { destinationUrl, name, folderId } = result.data;\n\n  // Validate URL format\n  if (!isValidUrl(destinationUrl)) {\n    return NextResponse.json(\n      { error: \"Invalid URL. Must be a valid http or https URL.\" },\n      { status: 400 }\n    );\n  }\n\n  const safety = await checkUrlSafety(destinationUrl);\n  if (!safety.safe) {\n    return NextResponse.json(\n      {\n        error:\n          \"Destination URL was rejected because it appears unsafe (Google Safe Browsing).\",\n      },\n      { status: 400 }\n    );\n  }\n\n  // Generate unique short code\n  const shortCode = await generateUniqueShortCode();\n\n  // Create QR code record\n  const [newQrCode] = await db\n    .insert(qrCodes)\n    .values({\n      userId: session.user.id,\n      shortCode,\n      destinationUrl,\n      name: name || null,\n      folderId: folderId || null,\n    })\n    .returning();\n\n  return NextResponse.json(\n    {\n      id: newQrCode.id,\n      shortCode: newQrCode.shortCode,\n      shortUrl: buildShortUrl(newQrCode.shortCode),\n      destinationUrl: newQrCode.destinationUrl,\n      name: newQrCode.name,\n      folderId: newQrCode.folderId,\n      isActive: newQrCode.isActive,\n      scanCount: newQrCode.scanCount,\n      createdAt: newQrCode.createdAt.toISOString(),\n    },\n    { status: 201 }\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/api/stripe/checkout/route.ts","messages":[{"ruleId":"complexity","severity":2,"message":"Async function 'POST' has a complexity of 11. Maximum allowed is 10.","line":15,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":15,"endColumn":27}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from \"next/server\";\nimport { z } from \"zod\";\nimport { auth } from \"@/lib/auth\";\nimport { db } from \"@/lib/db\";\nimport { users } from \"@/lib/db/schema\";\nimport { eq } from \"drizzle-orm\";\nimport { stripe, getPriceId } from \"@/lib/stripe\";\n\nconst checkoutSchema = z.object({\n  plan: z.enum([\"pro\", \"business\"]),\n  period: z.enum([\"monthly\", \"annual\"]),\n});\n\n// POST /api/stripe/checkout - Create Stripe Checkout session\nexport async function POST(request: NextRequest) {\n  const session = await auth();\n\n  if (!session?.user?.id) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  let body;\n  try {\n    body = await request.json();\n  } catch {\n    return NextResponse.json({ error: \"Invalid JSON body\" }, { status: 400 });\n  }\n\n  const result = checkoutSchema.safeParse(body);\n  if (!result.success) {\n    return NextResponse.json(\n      { error: \"Validation failed\", details: result.error.flatten() },\n      { status: 400 }\n    );\n  }\n\n  const { plan, period } = result.data;\n  const priceId = getPriceId(plan, period);\n\n  // Get user to check if they already have a Stripe customer ID\n  const user = await db.query.users.findFirst({\n    where: eq(users.id, session.user.id),\n  });\n\n  if (!user) {\n    return NextResponse.json({ error: \"User not found\" }, { status: 404 });\n  }\n\n  // Get or create Stripe customer\n  let customerId = user.stripeCustomerId;\n\n  if (!customerId) {\n    const customer = await stripe.customers.create({\n      email: user.email,\n      name: user.name || undefined,\n      metadata: {\n        userId: user.id,\n      },\n    });\n    customerId = customer.id;\n\n    // Save Stripe customer ID to user record\n    await db\n      .update(users)\n      .set({ stripeCustomerId: customerId, updatedAt: new Date() })\n      .where(eq(users.id, user.id));\n  }\n\n  // Build success and cancel URLs\n  const origin = request.headers.get(\"origin\") || process.env.NEXTAUTH_URL || \"http://localhost:3000\";\n  const successUrl = `${origin}/billing?success=true&session_id={CHECKOUT_SESSION_ID}`;\n  const cancelUrl = `${origin}/billing?canceled=true`;\n\n  // Create Checkout Session\n  const checkoutSession = await stripe.checkout.sessions.create({\n    customer: customerId,\n    mode: \"subscription\",\n    payment_method_types: [\"card\"],\n    line_items: [\n      {\n        price: priceId,\n        quantity: 1,\n      },\n    ],\n    success_url: successUrl,\n    cancel_url: cancelUrl,\n    metadata: {\n      userId: user.id,\n      plan,\n      period,\n    },\n    subscription_data: {\n      metadata: {\n        userId: user.id,\n        plan,\n      },\n    },\n  });\n\n  return NextResponse.json({\n    url: checkoutSession.url,\n    sessionId: checkoutSession.id,\n  });\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/api/stripe/portal/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/api/stripe/webhook/route.ts","messages":[{"ruleId":"complexity","severity":2,"message":"Async function 'handleCheckoutSessionCompleted' has a complexity of 12. Maximum allowed is 10.","line":84,"column":1,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":84,"endColumn":46}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from \"next/server\";\nimport { stripe, getPlanFromPriceId } from \"@/lib/stripe\";\nimport { db } from \"@/lib/db\";\nimport { subscriptions, users } from \"@/lib/db/schema\";\nimport { eq } from \"drizzle-orm\";\nimport Stripe from \"stripe\";\n\nconst webhookSecret = process.env.STRIPE_WEBHOOK_SECRET;\n\n// POST /api/stripe/webhook - Handle Stripe webhook events\nexport async function POST(request: NextRequest) {\n  if (!webhookSecret) {\n    console.error(\"STRIPE_WEBHOOK_SECRET is not set\");\n    return NextResponse.json(\n      { error: \"Webhook secret not configured\" },\n      { status: 500 }\n    );\n  }\n\n  const body = await request.text();\n  const signature = request.headers.get(\"stripe-signature\");\n\n  if (!signature) {\n    return NextResponse.json(\n      { error: \"Missing stripe-signature header\" },\n      { status: 400 }\n    );\n  }\n\n  let event: Stripe.Event;\n\n  // Verify webhook signature\n  try {\n    event = stripe.webhooks.constructEvent(body, signature, webhookSecret);\n  } catch (err) {\n    const message = err instanceof Error ? err.message : \"Unknown error\";\n    console.error(`Webhook signature verification failed: ${message}`);\n    return NextResponse.json(\n      { error: `Webhook signature verification failed: ${message}` },\n      { status: 400 }\n    );\n  }\n\n  // Handle the event\n  try {\n    switch (event.type) {\n      case \"checkout.session.completed\":\n        await handleCheckoutSessionCompleted(\n          event.data.object as Stripe.Checkout.Session\n        );\n        break;\n\n      case \"customer.subscription.updated\":\n        await handleSubscriptionUpdated(\n          event.data.object as Stripe.Subscription\n        );\n        break;\n\n      case \"customer.subscription.deleted\":\n        await handleSubscriptionDeleted(\n          event.data.object as Stripe.Subscription\n        );\n        break;\n\n      case \"invoice.payment_failed\":\n        await handleInvoicePaymentFailed(event.data.object as Stripe.Invoice);\n        break;\n\n      default:\n        console.log(`Unhandled event type: ${event.type}`);\n    }\n\n    return NextResponse.json({ received: true });\n  } catch (error) {\n    console.error(`Error handling webhook event: ${error}`);\n    return NextResponse.json(\n      { error: \"Webhook handler failed\" },\n      { status: 500 }\n    );\n  }\n}\n\n// Handle checkout.session.completed - Create subscription record\nasync function handleCheckoutSessionCompleted(\n  session: Stripe.Checkout.Session\n) {\n  if (session.mode !== \"subscription\" || !session.subscription) {\n    return;\n  }\n\n  const userId = session.metadata?.userId;\n  if (!userId) {\n    console.error(\"No userId in checkout session metadata\");\n    return;\n  }\n\n  // Retrieve the subscription to get full details\n  const subscriptionResponse = await stripe.subscriptions.retrieve(\n    session.subscription as string\n  );\n  // Handle both Response wrapper and direct object\n  const subscription = \"data\" in subscriptionResponse\n    ? (subscriptionResponse as unknown as { data: Stripe.Subscription }).data\n    : subscriptionResponse;\n\n  const subscriptionItem = subscription.items.data[0];\n  const priceId = subscriptionItem?.price.id;\n  const plan = getPlanFromPriceId(priceId);\n\n  if (!plan) {\n    console.error(`Unknown price ID: ${priceId}`);\n    return;\n  }\n\n  // Check if subscription already exists\n  const existing = await db.query.subscriptions.findFirst({\n    where: eq(subscriptions.stripeSubscriptionId, subscription.id),\n  });\n\n  // Get period from the subscription item\n  const periodStart = new Date(subscriptionItem.current_period_start * 1000);\n  const periodEnd = new Date(subscriptionItem.current_period_end * 1000);\n\n  if (existing) {\n    // Update existing subscription\n    await db\n      .update(subscriptions)\n      .set({\n        stripePriceId: priceId,\n        plan,\n        status: subscription.status === \"active\" ? \"active\" : subscription.status,\n        currentPeriodStart: periodStart,\n        currentPeriodEnd: periodEnd,\n        updatedAt: new Date(),\n      })\n      .where(eq(subscriptions.stripeSubscriptionId, subscription.id));\n  } else {\n    // Create new subscription record\n    await db.insert(subscriptions).values({\n      userId,\n      stripeSubscriptionId: subscription.id,\n      stripePriceId: priceId,\n      plan,\n      status: subscription.status === \"active\" ? \"active\" : subscription.status,\n      currentPeriodStart: periodStart,\n      currentPeriodEnd: periodEnd,\n    });\n  }\n\n  // Update user's stripeCustomerId if not set\n  if (session.customer) {\n    await db\n      .update(users)\n      .set({\n        stripeCustomerId: session.customer as string,\n        updatedAt: new Date(),\n      })\n      .where(eq(users.id, userId));\n  }\n}\n\n// Handle customer.subscription.updated - Update subscription status\nasync function handleSubscriptionUpdated(subscription: Stripe.Subscription) {\n  const subscriptionItem = subscription.items.data[0];\n  const priceId = subscriptionItem?.price.id;\n  const plan = getPlanFromPriceId(priceId);\n\n  // Map Stripe status to our status\n  let status: string;\n  switch (subscription.status) {\n    case \"active\":\n    case \"trialing\":\n      status = \"active\";\n      break;\n    case \"past_due\":\n      status = \"past_due\";\n      break;\n    case \"canceled\":\n    case \"unpaid\":\n      status = \"canceled\";\n      break;\n    default:\n      status = subscription.status;\n  }\n\n  // Get period from the subscription item\n  const periodStart = subscriptionItem\n    ? new Date(subscriptionItem.current_period_start * 1000)\n    : new Date();\n  const periodEnd = subscriptionItem\n    ? new Date(subscriptionItem.current_period_end * 1000)\n    : new Date();\n\n  await db\n    .update(subscriptions)\n    .set({\n      stripePriceId: priceId,\n      plan: plan || undefined,\n      status,\n      currentPeriodStart: periodStart,\n      currentPeriodEnd: periodEnd,\n      updatedAt: new Date(),\n    })\n    .where(eq(subscriptions.stripeSubscriptionId, subscription.id));\n}\n\n// Handle customer.subscription.deleted - Mark subscription as canceled\nasync function handleSubscriptionDeleted(subscription: Stripe.Subscription) {\n  await db\n    .update(subscriptions)\n    .set({\n      status: \"canceled\",\n      updatedAt: new Date(),\n    })\n    .where(eq(subscriptions.stripeSubscriptionId, subscription.id));\n}\n\n// Handle invoice.payment_failed - Update status to past_due\nasync function handleInvoicePaymentFailed(invoice: Stripe.Invoice) {\n  // Get subscription from parent.subscription_details (new API structure)\n  const subscriptionData = invoice.parent?.subscription_details?.subscription;\n  if (!subscriptionData) {\n    return;\n  }\n\n  const subscriptionId =\n    typeof subscriptionData === \"string\"\n      ? subscriptionData\n      : subscriptionData.id;\n\n  await db\n    .update(subscriptions)\n    .set({\n      status: \"past_due\",\n      updatedAt: new Date(),\n    })\n    .where(eq(subscriptions.stripeSubscriptionId, subscriptionId));\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/api/tags/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/api/user/route.ts","messages":[{"ruleId":"complexity","severity":2,"message":"Async function 'PATCH' has a complexity of 11. Maximum allowed is 10.","line":13,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":13,"endColumn":28}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from \"next/server\";\nimport { z } from \"zod\";\nimport { auth } from \"@/lib/auth\";\nimport { db } from \"@/lib/db\";\nimport { users } from \"@/lib/db/schema\";\nimport { eq } from \"drizzle-orm\";\n\nconst updateUserSchema = z.object({\n  name: z.string().max(255).nullable().optional(),\n});\n\n// PATCH /api/user - Update current user profile\nexport async function PATCH(request: NextRequest) {\n  const session = await auth();\n\n  if (!session?.user?.id) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  let body: unknown;\n  try {\n    body = await request.json();\n  } catch {\n    return NextResponse.json({ error: \"Invalid JSON body\" }, { status: 400 });\n  }\n\n  const result = updateUserSchema.safeParse(body);\n  if (!result.success) {\n    return NextResponse.json(\n      { error: \"Validation failed\", details: result.error.flatten() },\n      { status: 400 }\n    );\n  }\n\n  const rawName = result.data.name;\n  const nameUpdate =\n    typeof rawName === \"string\"\n      ? rawName.trim() || null\n      : rawName === null\n        ? null\n        : undefined;\n\n  const updateData: Partial<typeof users.$inferInsert> = {\n    updatedAt: new Date(),\n  };\n  if (nameUpdate !== undefined) {\n    updateData.name = nameUpdate;\n  }\n\n  const [updated] = await db\n    .update(users)\n    .set(updateData)\n    .where(eq(users.id, session.user.id))\n    .returning({\n      id: users.id,\n      email: users.email,\n      name: users.name,\n    });\n\n  if (!updated) {\n    return NextResponse.json({ error: \"User not found\" }, { status: 404 });\n  }\n\n  return NextResponse.json({\n    id: updated.id,\n    email: updated.email,\n    name: updated.name,\n  });\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/error.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/go/[code]/gone/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/go/[code]/not-found/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/go/[code]/route.ts","messages":[{"ruleId":"complexity","severity":2,"message":"Async function 'GET' has a complexity of 13. Maximum allowed is 10.","line":14,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":14,"endColumn":26}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from \"next/server\";\nimport { db } from \"@/lib/db\";\nimport { qrCodes } from \"@/lib/db/schema\";\nimport { eq } from \"drizzle-orm\";\nimport { isBot, hashIP, logScanEvent } from \"@/lib/analytics\";\nimport { limitRedirectByIp } from \"@/lib/ratelimit\";\n\nexport const runtime = \"nodejs\";\n\ninterface RouteContext {\n  params: Promise<{ code: string }>;\n}\n\nexport async function GET(request: NextRequest, context: RouteContext) {\n  const { code } = await context.params;\n\n  // Rate limit by IP (protects the redirect endpoint from abuse)\n  const ip =\n    request.headers.get(\"x-forwarded-for\")?.split(\",\")[0]?.trim() ||\n    request.headers.get(\"x-real-ip\") ||\n    \"unknown\";\n\n  const rate = await limitRedirectByIp(ip);\n  const rateLimitHeaders = {\n    \"X-RateLimit-Limit\": String(rate.limit),\n    \"X-RateLimit-Remaining\": String(rate.remaining),\n    \"X-RateLimit-Reset\": String(rate.reset),\n  };\n\n  if (!rate.success) {\n    const retryAfterSeconds = Math.max(\n      0,\n      Math.ceil((rate.reset - Date.now()) / 1000)\n    );\n\n    return NextResponse.json(\n      { error: \"Too many requests\" },\n      {\n        status: 429,\n        headers: {\n          ...rateLimitHeaders,\n          \"Retry-After\": String(retryAfterSeconds),\n        },\n      }\n    );\n  }\n\n  // Lookup QR code by short code\n  const qrCode = await db.query.qrCodes.findFirst({\n    where: eq(qrCodes.shortCode, code),\n    columns: {\n      id: true,\n      destinationUrl: true,\n      isActive: true,\n    },\n  });\n\n  // Not found\n  if (!qrCode) {\n    const baseUrl = process.env.NEXTAUTH_URL || \"http://localhost:3000\";\n    return NextResponse.redirect(`${baseUrl}/go/${code}/not-found`, {\n      status: 302,\n      headers: rateLimitHeaders,\n    });\n  }\n\n  // Code is deactivated\n  if (!qrCode.isActive) {\n    const baseUrl = process.env.NEXTAUTH_URL || \"http://localhost:3000\";\n    return NextResponse.redirect(`${baseUrl}/go/${code}/gone`, {\n      status: 302,\n      headers: rateLimitHeaders,\n    });\n  }\n\n  // Log scan event asynchronously (don't block redirect)\n  const userAgent = request.headers.get(\"user-agent\") || \"\";\n\n  // Only log human scans, filter out bots\n  if (!isBot(userAgent)) {\n    // Get country from Vercel geo headers (available on Vercel Edge)\n    const country = request.headers.get(\"x-vercel-ip-country\") || undefined;\n\n    // Get IP and hash it for privacy\n    // Fire and forget - don't await to avoid blocking redirect\n    hashIP(ip).then((ipHash) => {\n      logScanEvent(qrCode.id, country, ipHash).catch((error) => {\n        console.error(\"Failed to log scan event:\", error);\n      });\n    });\n  }\n\n  // Redirect to destination\n  return NextResponse.redirect(qrCode.destinationUrl, {\n    status: 302,\n    headers: {\n      \"Cache-Control\": \"no-store, max-age=0\",\n      ...rateLimitHeaders,\n    },\n  });\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/app/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/components/analytics-chart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/components/folder-sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/components/qr-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/components/qr-create-modal.tsx","messages":[{"ruleId":"complexity","severity":2,"message":"Function 'QRCreateModal' has a complexity of 15. Maximum allowed is 10.","line":39,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":39,"endColumn":30},{"ruleId":"complexity","severity":2,"message":"Async arrow function has a complexity of 13. Maximum allowed is 10.","line":91,"column":51,"nodeType":"ArrowFunctionExpression","messageId":"complex","endLine":91,"endColumn":53},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":222,"column":19,"nodeType":"JSXOpeningElement","endLine":226,"endColumn":21}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect, useSyncExternalStore } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport QRCode from \"qrcode\";\nimport { useToast } from \"@/components/ui/toast\";\nimport { getApiErrorMessage, getApiFieldError } from \"@/lib/errors\";\n\ninterface QRCreateModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  folders?: { id: string; name: string }[];\n}\n\n// QR code store for managing async generation\nfunction createQRStore() {\n  let snapshot = { dataUrl: \"\", svgString: \"\" };\n  const listeners = new Set<() => void>();\n\n  return {\n    getSnapshot: () => snapshot,\n    subscribe: (listener: () => void) => {\n      listeners.add(listener);\n      return () => listeners.delete(listener);\n    },\n    setData: (png: string, svg: string) => {\n      if (snapshot.dataUrl !== png || snapshot.svgString !== svg) {\n        snapshot = { dataUrl: png, svgString: svg };\n        listeners.forEach((l) => l());\n      }\n    },\n  };\n}\n\nconst qrStore = createQRStore();\n\nexport function QRCreateModal({ isOpen, onClose, folders = [] }: QRCreateModalProps) {\n  const router = useRouter();\n  const toast = useToast();\n  const [destinationUrl, setDestinationUrl] = useState(\"\");\n  const [name, setName] = useState(\"\");\n  const [folderId, setFolderId] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [fieldErrors, setFieldErrors] = useState<{\n    destinationUrl?: string;\n    name?: string;\n    folderId?: string;\n  }>({});\n  const [createdQR, setCreatedQR] = useState<{\n    id: string;\n    shortCode: string;\n    shortUrl: string;\n  } | null>(null);\n  const [copied, setCopied] = useState(false);\n\n  const qrData = useSyncExternalStore(qrStore.subscribe, qrStore.getSnapshot, qrStore.getSnapshot);\n\n  // Generate QR code preview when URL changes\n  useEffect(() => {\n    if (!createdQR?.shortUrl) {\n      qrStore.setData(\"\", \"\");\n      return;\n    }\n\n    const generateQR = async () => {\n      try {\n        const [pngUrl, svgStr] = await Promise.all([\n          QRCode.toDataURL(createdQR.shortUrl, {\n            width: 256,\n            margin: 2,\n            errorCorrectionLevel: \"M\",\n          }),\n          QRCode.toString(createdQR.shortUrl, {\n            type: \"svg\",\n            margin: 2,\n            errorCorrectionLevel: \"M\",\n          }),\n        ]);\n        qrStore.setData(pngUrl, svgStr);\n      } catch (err) {\n        console.error(\"Failed to generate QR code:\", err);\n      }\n    };\n\n    generateQR();\n  }, [createdQR?.shortUrl]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n    setFieldErrors({});\n    setIsLoading(true);\n\n    try {\n      const response = await fetch(\"/api/qr\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          destinationUrl,\n          name: name || undefined,\n          folderId: folderId || undefined,\n        }),\n      });\n\n      const data = (await response.json().catch(() => null)) as unknown;\n\n      if (!response.ok) {\n        const message = getApiErrorMessage(data) || \"Failed to create QR code\";\n        setError(message);\n        setFieldErrors({\n          destinationUrl: getApiFieldError(data, \"destinationUrl\") || undefined,\n          name: getApiFieldError(data, \"name\") || undefined,\n          folderId: getApiFieldError(data, \"folderId\") || undefined,\n        });\n        toast.error(message);\n        return;\n      }\n\n      const created = data as {\n        id?: unknown;\n        shortCode?: unknown;\n        shortUrl?: unknown;\n      };\n\n      if (\n        !created ||\n        typeof created.id !== \"string\" ||\n        typeof created.shortCode !== \"string\" ||\n        typeof created.shortUrl !== \"string\"\n      ) {\n        throw new Error(\"Invalid create QR response\");\n      }\n\n      toast.success(\"QR code created\");\n      setCreatedQR({\n        id: created.id,\n        shortCode: created.shortCode,\n        shortUrl: created.shortUrl,\n      });\n    } catch {\n      setError(\"An unexpected error occurred\");\n      toast.error(\"An unexpected error occurred\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleCopyUrl = async () => {\n    if (!createdQR?.shortUrl) return;\n    try {\n      await navigator.clipboard.writeText(createdQR.shortUrl);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    } catch (err) {\n      console.error(\"Failed to copy:\", err);\n    }\n  };\n\n  const handleDownload = (format: \"png\" | \"svg\") => {\n    if (!createdQR) return;\n\n    const timestamp = Date.now();\n    const filename = `qr-code-${createdQR.shortCode}-${timestamp}.${format}`;\n\n    if (format === \"png\" && qrData.dataUrl) {\n      const link = document.createElement(\"a\");\n      link.download = filename;\n      link.href = qrData.dataUrl;\n      link.click();\n    } else if (format === \"svg\" && qrData.svgString) {\n      const blob = new Blob([qrData.svgString], { type: \"image/svg+xml\" });\n      const url = URL.createObjectURL(blob);\n      const link = document.createElement(\"a\");\n      link.download = filename;\n      link.href = url;\n      link.click();\n      URL.revokeObjectURL(url);\n    }\n  };\n\n  const handleClose = () => {\n    setDestinationUrl(\"\");\n    setName(\"\");\n    setFolderId(\"\");\n    setError(null);\n    setCreatedQR(null);\n    qrStore.setData(\"\", \"\");\n    onClose();\n    if (createdQR) {\n      router.refresh(); // Refresh the list if a QR was created\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\n      <div className=\"bg-white rounded-lg shadow-xl w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto\">\n        <div className=\"p-6\">\n          <div className=\"flex items-center justify-between mb-6\">\n            <h2 className=\"text-xl font-bold text-gray-900\">\n              {createdQR ? \"QR Code Created!\" : \"Create New QR Code\"}\n            </h2>\n            <button\n              onClick={handleClose}\n              className=\"text-gray-400 hover:text-gray-600\"\n            >\n              <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n              </svg>\n            </button>\n          </div>\n\n          {createdQR ? (\n            // Success state with QR preview\n            <div className=\"text-center\">\n              {qrData.dataUrl && (\n                <div className=\"mb-6\">\n                  <img\n                    src={qrData.dataUrl}\n                    alt=\"Generated QR Code\"\n                    className=\"mx-auto w-48 h-48 border rounded-lg\"\n                  />\n                </div>\n              )}\n\n              <div className=\"mb-6\">\n                <p className=\"text-sm text-gray-500 mb-2\">Your short URL:</p>\n                <div className=\"flex items-center justify-center gap-2\">\n                  <code className=\"text-lg font-mono text-blue-600 bg-blue-50 px-3 py-1 rounded\">\n                    {createdQR.shortUrl}\n                  </code>\n                  <button\n                    onClick={handleCopyUrl}\n                    className=\"p-2 text-gray-400 hover:text-gray-600\"\n                    title=\"Copy URL\"\n                  >\n                    {copied ? (\n                      <svg className=\"w-5 h-5 text-green-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                      </svg>\n                    ) : (\n                      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\" />\n                      </svg>\n                    )}\n                  </button>\n                </div>\n              </div>\n\n              <div className=\"flex gap-3 justify-center mb-6\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => handleDownload(\"png\")}\n                  disabled={!qrData.dataUrl}\n                >\n                  Download PNG\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  onClick={() => handleDownload(\"svg\")}\n                  disabled={!qrData.svgString}\n                >\n                  Download SVG\n                </Button>\n              </div>\n\n              <div className=\"flex gap-3 justify-center\">\n                <Button variant=\"outline\" onClick={handleClose}>\n                  Close\n                </Button>\n                <Button\n                  variant=\"primary\"\n                  onClick={() => router.push(`/qr/${createdQR.id}`)}\n                >\n                  View Details\n                </Button>\n              </div>\n            </div>\n          ) : (\n            // Creation form\n            <form onSubmit={handleSubmit}>\n              {error && (\n                <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm\">\n                  {error}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div>\n                  <label\n                    htmlFor=\"destinationUrl\"\n                    className=\"block text-sm font-medium text-gray-700 mb-1\"\n                  >\n                    Destination URL <span className=\"text-red-500\">*</span>\n                  </label>\n                  <Input\n                    id=\"destinationUrl\"\n                    type=\"url\"\n                    value={destinationUrl}\n                    onChange={(e) => setDestinationUrl(e.target.value)}\n                    placeholder=\"https://example.com\"\n                    required\n                    disabled={isLoading}\n                    className={fieldErrors.destinationUrl ? \"border-red-500\" : \"\"}\n                  />\n                  {fieldErrors.destinationUrl && (\n                    <p className=\"mt-1 text-sm text-red-600\">\n                      {fieldErrors.destinationUrl}\n                    </p>\n                  )}\n                  <p className=\"mt-1 text-xs text-gray-500\">\n                    The URL where your QR code will redirect to\n                  </p>\n                </div>\n\n                <div>\n                  <label\n                    htmlFor=\"name\"\n                    className=\"block text-sm font-medium text-gray-700 mb-1\"\n                  >\n                    Name <span className=\"text-gray-400\">(optional)</span>\n                  </label>\n                  <Input\n                    id=\"name\"\n                    type=\"text\"\n                    value={name}\n                    onChange={(e) => setName(e.target.value)}\n                    placeholder=\"My QR Code\"\n                    disabled={isLoading}\n                    className={fieldErrors.name ? \"border-red-500\" : \"\"}\n                  />\n                  {fieldErrors.name && (\n                    <p className=\"mt-1 text-sm text-red-600\">\n                      {fieldErrors.name}\n                    </p>\n                  )}\n                  <p className=\"mt-1 text-xs text-gray-500\">\n                    A friendly name to help you identify this QR code\n                  </p>\n                </div>\n\n                {folders.length > 0 && (\n                  <div>\n                    <label\n                      htmlFor=\"folder\"\n                      className=\"block text-sm font-medium text-gray-700 mb-1\"\n                    >\n                      Folder <span className=\"text-gray-400\">(optional)</span>\n                    </label>\n                    <select\n                      id=\"folder\"\n                      value={folderId}\n                      onChange={(e) => setFolderId(e.target.value)}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                      disabled={isLoading}\n                    >\n                      <option value=\"\">No folder</option>\n                      {folders.map((folder) => (\n                        <option key={folder.id} value={folder.id}>\n                          {folder.name}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"mt-6 flex gap-3 justify-end\">\n                <Button type=\"button\" variant=\"outline\" onClick={handleClose} disabled={isLoading}>\n                  Cancel\n                </Button>\n                <Button type=\"submit\" variant=\"primary\" disabled={isLoading}>\n                  {isLoading ? \"Creating...\" : \"Create QR Code\"}\n                </Button>\n              </div>\n            </form>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/components/qr-generator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/components/tag-input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/components/ui/button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/components/ui/input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/components/ui/select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/components/ui/toast.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/lib/analytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/lib/auth-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/lib/auth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/lib/db/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/lib/db/schema.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'one' is defined but never used.","line":31,"column":57,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":60}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\n  pgTable,\n  uuid,\n  varchar,\n  timestamp,\n  boolean,\n  integer,\n  text,\n  uniqueIndex,\n  index,\n  primaryKey,\n} from \"drizzle-orm/pg-core\";\nimport { relations } from \"drizzle-orm\";\n\n// ============================================================================\n// Users\n// ============================================================================\n\nexport const users = pgTable(\"users\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  email: varchar(\"email\", { length: 255 }).notNull().unique(),\n  emailVerified: timestamp(\"email_verified\", { mode: \"date\" }),\n  passwordHash: varchar(\"password_hash\", { length: 255 }), // null if OAuth-only\n  name: varchar(\"name\", { length: 255 }),\n  image: varchar(\"image\", { length: 500 }),\n  stripeCustomerId: varchar(\"stripe_customer_id\", { length: 255 }),\n  createdAt: timestamp(\"created_at\", { mode: \"date\" }).defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\", { mode: \"date\" }).defaultNow().notNull(),\n});\n\nexport const usersRelations = relations(users, ({ many, one }) => ({\n  subscriptions: many(subscriptions),\n  qrCodes: many(qrCodes),\n  folders: many(folders),\n  tags: many(tags),\n  accounts: many(accounts),\n  sessions: many(sessions),\n}));\n\n// ============================================================================\n// Subscriptions\n// ============================================================================\n\nexport const subscriptions = pgTable(\"subscriptions\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  userId: uuid(\"user_id\")\n    .references(() => users.id, { onDelete: \"cascade\" })\n    .notNull(),\n  stripeSubscriptionId: varchar(\"stripe_subscription_id\", {\n    length: 255,\n  }).notNull(),\n  stripePriceId: varchar(\"stripe_price_id\", { length: 255 }).notNull(),\n  plan: varchar(\"plan\", { length: 50 }).notNull(), // 'pro' | 'business'\n  status: varchar(\"status\", { length: 50 }).notNull(), // 'active' | 'canceled' | 'past_due'\n  currentPeriodStart: timestamp(\"current_period_start\", {\n    mode: \"date\",\n  }).notNull(),\n  currentPeriodEnd: timestamp(\"current_period_end\", { mode: \"date\" }).notNull(),\n  createdAt: timestamp(\"created_at\", { mode: \"date\" }).defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\", { mode: \"date\" }).defaultNow().notNull(),\n});\n\nexport const subscriptionsRelations = relations(subscriptions, ({ one }) => ({\n  user: one(users, {\n    fields: [subscriptions.userId],\n    references: [users.id],\n  }),\n}));\n\n// ============================================================================\n// QR Codes\n// ============================================================================\n\nexport const qrCodes = pgTable(\n  \"qr_codes\",\n  {\n    id: uuid(\"id\").primaryKey().defaultRandom(),\n    userId: uuid(\"user_id\")\n      .references(() => users.id, { onDelete: \"cascade\" })\n      .notNull(),\n    shortCode: varchar(\"short_code\", { length: 20 }).notNull().unique(),\n    destinationUrl: varchar(\"destination_url\", { length: 2000 }).notNull(),\n    name: varchar(\"name\", { length: 255 }),\n    folderId: uuid(\"folder_id\").references(() => folders.id, {\n      onDelete: \"set null\",\n    }),\n    isActive: boolean(\"is_active\").default(true).notNull(),\n    scanCount: integer(\"scan_count\").default(0).notNull(),\n    createdAt: timestamp(\"created_at\", { mode: \"date\" }).defaultNow().notNull(),\n    updatedAt: timestamp(\"updated_at\", { mode: \"date\" }).defaultNow().notNull(),\n  },\n  (table) => [\n    uniqueIndex(\"short_code_idx\").on(table.shortCode),\n    index(\"qr_user_id_idx\").on(table.userId),\n  ]\n);\n\nexport const qrCodesRelations = relations(qrCodes, ({ one, many }) => ({\n  user: one(users, {\n    fields: [qrCodes.userId],\n    references: [users.id],\n  }),\n  folder: one(folders, {\n    fields: [qrCodes.folderId],\n    references: [folders.id],\n  }),\n  scanEvents: many(scanEvents),\n  qrCodeTags: many(qrCodeTags),\n}));\n\n// ============================================================================\n// Folders\n// ============================================================================\n\nexport const folders = pgTable(\"folders\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  userId: uuid(\"user_id\")\n    .references(() => users.id, { onDelete: \"cascade\" })\n    .notNull(),\n  name: varchar(\"name\", { length: 255 }).notNull(),\n  createdAt: timestamp(\"created_at\", { mode: \"date\" }).defaultNow().notNull(),\n});\n\nexport const foldersRelations = relations(folders, ({ one, many }) => ({\n  user: one(users, {\n    fields: [folders.userId],\n    references: [users.id],\n  }),\n  qrCodes: many(qrCodes),\n}));\n\n// ============================================================================\n// Tags\n// ============================================================================\n\nexport const tags = pgTable(\"tags\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  userId: uuid(\"user_id\")\n    .references(() => users.id, { onDelete: \"cascade\" })\n    .notNull(),\n  name: varchar(\"name\", { length: 100 }).notNull(),\n});\n\nexport const tagsRelations = relations(tags, ({ one, many }) => ({\n  user: one(users, {\n    fields: [tags.userId],\n    references: [users.id],\n  }),\n  qrCodeTags: many(qrCodeTags),\n}));\n\n// QR Code <-> Tag junction table\nexport const qrCodeTags = pgTable(\n  \"qr_code_tags\",\n  {\n    qrCodeId: uuid(\"qr_code_id\")\n      .references(() => qrCodes.id, { onDelete: \"cascade\" })\n      .notNull(),\n    tagId: uuid(\"tag_id\")\n      .references(() => tags.id, { onDelete: \"cascade\" })\n      .notNull(),\n  },\n  (table) => [primaryKey({ columns: [table.qrCodeId, table.tagId] })]\n);\n\nexport const qrCodeTagsRelations = relations(qrCodeTags, ({ one }) => ({\n  qrCode: one(qrCodes, {\n    fields: [qrCodeTags.qrCodeId],\n    references: [qrCodes.id],\n  }),\n  tag: one(tags, {\n    fields: [qrCodeTags.tagId],\n    references: [tags.id],\n  }),\n}));\n\n// ============================================================================\n// Scan Events\n// ============================================================================\n\nexport const scanEvents = pgTable(\n  \"scan_events\",\n  {\n    id: uuid(\"id\").primaryKey().defaultRandom(),\n    qrCodeId: uuid(\"qr_code_id\")\n      .references(() => qrCodes.id, { onDelete: \"cascade\" })\n      .notNull(),\n    scannedAt: timestamp(\"scanned_at\", { mode: \"date\" }).defaultNow().notNull(),\n    country: varchar(\"country\", { length: 2 }), // ISO 3166-1 alpha-2\n    ipHash: varchar(\"ip_hash\", { length: 64 }), // SHA-256 for deduplication\n  },\n  (table) => [\n    index(\"scan_qr_code_id_idx\").on(table.qrCodeId),\n    index(\"scan_scanned_at_idx\").on(table.scannedAt),\n    index(\"scan_qr_code_id_scanned_at_idx\").on(table.qrCodeId, table.scannedAt),\n  ]\n);\n\nexport const scanEventsRelations = relations(scanEvents, ({ one }) => ({\n  qrCode: one(qrCodes, {\n    fields: [scanEvents.qrCodeId],\n    references: [qrCodes.id],\n  }),\n}));\n\n// ============================================================================\n// NextAuth.js Tables (required by @auth/drizzle-adapter)\n// ============================================================================\n\nexport const accounts = pgTable(\n  \"accounts\",\n  {\n    userId: uuid(\"user_id\")\n      .references(() => users.id, { onDelete: \"cascade\" })\n      .notNull(),\n    type: varchar(\"type\", { length: 255 }).notNull(),\n    provider: varchar(\"provider\", { length: 255 }).notNull(),\n    providerAccountId: varchar(\"provider_account_id\", {\n      length: 255,\n    }).notNull(),\n    refresh_token: text(\"refresh_token\"),\n    access_token: text(\"access_token\"),\n    expires_at: integer(\"expires_at\"),\n    token_type: varchar(\"token_type\", { length: 255 }),\n    scope: varchar(\"scope\", { length: 255 }),\n    id_token: text(\"id_token\"),\n    session_state: varchar(\"session_state\", { length: 255 }),\n  },\n  (table) => [\n    primaryKey({ columns: [table.provider, table.providerAccountId] }),\n  ]\n);\n\nexport const accountsRelations = relations(accounts, ({ one }) => ({\n  user: one(users, {\n    fields: [accounts.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const sessions = pgTable(\"sessions\", {\n  sessionToken: varchar(\"session_token\", { length: 255 }).primaryKey(),\n  userId: uuid(\"user_id\")\n    .references(() => users.id, { onDelete: \"cascade\" })\n    .notNull(),\n  expires: timestamp(\"expires\", { mode: \"date\" }).notNull(),\n});\n\nexport const sessionsRelations = relations(sessions, ({ one }) => ({\n  user: one(users, {\n    fields: [sessions.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const verificationTokens = pgTable(\n  \"verification_tokens\",\n  {\n    identifier: varchar(\"identifier\", { length: 255 }).notNull(),\n    token: varchar(\"token\", { length: 255 }).notNull(),\n    expires: timestamp(\"expires\", { mode: \"date\" }).notNull(),\n  },\n  (table) => [primaryKey({ columns: [table.identifier, table.token] })]\n);\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/lib/errors.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/lib/qr.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/lib/ratelimit.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/lib/redis.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/lib/safe-browsing.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/lib/stripe.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/lib/subscription.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/simple-qr-code-generator/lib/utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]